<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ä¼šè®®åŠ©æ‰‹ - èµåŒç§‘æŠ€æ•°å­—å‘˜å·¥</title>
    <script src="/console/style/tailwindcss.3.0.23.js"></script>
    <script src="/scripts/mermaid.min.js"></script>
    <style>
        body {
            /* background: linear-gradient(135deg, #f0f2f5 0%, #e8ecf0 50%, #f5f7fa 100%); */
            min-height: 100vh;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
        }
        
        .liquid-glass {
            background: rgba(255, 255, 255, 0.85);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.3);
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
        }
        
        .liquid-glass-strong {
            /* background: rgba(255, 255, 255, 0.9); */
            backdrop-filter: blur(25px);
            border: 1px solid rgba(255, 255, 255, 0.4);
            box-shadow: 0 12px 40px rgba(0, 0, 0, 0.12);
        }
        
        .specular-highlight {
            position: relative;
            overflow: hidden;
        }
        
        .specular-highlight::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.4), transparent);
            transition: left 0.6s ease;
            pointer-events: none;
        }
        
        .specular-highlight:hover::before {
            left: 100%;
        }
        
        .feature-card {
            background: rgba(255, 255, 255, 0.5);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.3);
            border-radius: 16px;
            padding: 16px;
            transition: all 0.3s cubic-bezier(0.25, 0.46, 0.45, 0.94);
            cursor: pointer;
        }
        
        .feature-card:hover {
            transform: translateY(-4px);
            box-shadow: 0 16px 48px rgba(0, 0, 0, 0.1);
            border-color: rgba(34, 197, 94, 0.3);
            background: rgba(255, 255, 255, 0.95);
        }
        
        .message-bubble {
            max-width: 85%;
            word-wrap: break-word;
            animation: slideIn 0.3s ease-out;
        }
        
        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateY(10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        .user-message {
            background: linear-gradient(135deg, #10b981 0%, #059669 100%);
            color: white;
            margin-left: auto;
            border-radius: 18px 18px 4px 18px;
        }
        
        .assistant-message {
            background: rgba(255, 255, 255, 0.95);
            color: #374151;
            margin-right: auto;
            border-radius: 18px 18px 18px 4px;
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.3);
        }
        
        .typing-indicator {
            display: flex;
            align-items: center;
            padding: 12px 16px;
            background: rgba(255, 255, 255, 0.95);
            border-radius: 18px 18px 18px 4px;
            margin-right: auto;
            max-width: 85%;
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.3);
        }
        
        .typing-dot {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background: #9ca3af;
            margin: 0 2px;
            animation: typing 1.4s infinite;
        }
        
        .typing-dot:nth-child(2) {
            animation-delay: 0.2s;
        }
        
        .typing-dot:nth-child(3) {
            animation-delay: 0.4s;
        }
        
        @keyframes typing {
            0%, 60%, 100% {
                transform: translateY(0);
                opacity: 0.4;
            }
            30% {
                transform: translateY(-10px);
                opacity: 1;
            }
        }
        
        .source-reference {
            background: rgba(34, 197, 94, 0.1);
            border: 1px solid rgba(34, 197, 94, 0.2);
            border-radius: 8px;
            padding: 8px 12px;
            margin: 8px 0;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .source-reference:hover {
            background: rgba(34, 197, 94, 0.15);
            transform: translateY(-1px);
        }
        
        .floating-button {
            transform: translateY(0);
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }
        
        .floating-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 12px 40px rgba(0, 0, 0, 0.15);
        }
        
        .chat-input {
            background: rgba(255, 255, 255, 0.9);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.3);
            border-radius: 16px;
            padding: 12px 16px;
            outline: none;
            transition: all 0.3s ease;
        }
        
        .chat-input:focus {
            border-color: rgba(34, 197, 94, 0.5);
            box-shadow: 0 0 0 3px rgba(34, 197, 94, 0.1);
        }
        
        /* Toast æç¤ºæ ·å¼ */
        .toast {
            position: fixed;
            top: 20px;
            right: 20px;
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.3);
            border-radius: 12px;
            padding: 16px 20px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
            transform: translateX(400px);
            transition: transform 0.3s ease;
            z-index: 1001;
            min-width: 300px;
        }
        
        .toast.show {
            transform: translateX(0);
        }
        
        .toast.success {
            border-left: 4px solid #10b981;
        }
        
        .toast.error {
            border-left: 4px solid #ef4444;
        }
        
        .toast.info {
            border-left: 4px solid #10b981;
        }
        
        /* å¼¹çª—æ ·å¼ */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.5);
            backdrop-filter: blur(4px);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 1000;
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s ease;
        }
        
        .modal-overlay.show {
            opacity: 1;
            visibility: visible;
        }
        
        .modal-content {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(25px);
            border: 1px solid rgba(255, 255, 255, 0.3);
            border-radius: 20px;
            max-width: 600px;
            max-height: 80vh;
            margin: 20px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.2);
            transform: scale(0.9);
            transition: transform 0.3s ease;
            overflow: hidden;
        }
        
        .modal-overlay.show .modal-content {
            transform: scale(1);
        }
        
        /* æ¶ˆæ¯äº¤äº’æŒ‰é’® */
        .message-actions {
            margin-top: 12px;
            padding-top: 12px;
            border-top: 1px solid rgba(0, 0, 0, 0.05);
            display: flex;
            gap: 8px;
            align-items: center;
        }
        
        .action-btn {
            display: flex;
            align-items: center;
            gap: 4px;
            padding: 6px 12px;
            border-radius: 8px;
            border: 1px solid rgba(0, 0, 0, 0.1);
            background: rgba(255, 255, 255, 0.8);
            color: #6b7280;
            font-size: 12px;
            cursor: pointer;
            transition: all 0.2s ease;
        }
        
        .action-btn:hover {
            background: rgba(255, 255, 255, 0.95);
            border-color: rgba(34, 197, 94, 0.3);
            color: #374151;
        }
        
        .action-btn.active {
            background: rgba(34, 197, 94, 0.1);
            border-color: rgba(34, 197, 94, 0.3);
            color: #059669;
        }
        
        .action-btn.like.active {
            background: rgba(34, 197, 94, 0.1);
            border-color: rgba(34, 197, 94, 0.3);
            color: #059669;
        }
        
        .action-btn.dislike.active {
            background: rgba(239, 68, 68, 0.1);
            border-color: rgba(239, 68, 68, 0.3);
            color: #dc2626;
        }
        
        /* æ–‡ä»¶ä¸Šä¼ åŒºåŸŸ */
        .upload-area {
            border: 2px dashed rgba(34, 197, 94, 0.3);
            border-radius: 12px;
            padding: 20px;
            text-align: center;
            background: rgba(34, 197, 94, 0.05);
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .upload-area:hover {
            border-color: rgba(34, 197, 94, 0.5);
            background: rgba(34, 197, 94, 0.1);
        }
        
        .upload-area.dragover {
            border-color: rgba(34, 197, 94, 0.7);
            background: rgba(34, 197, 94, 0.15);
        }
        
        /* éŸ³é¢‘æ’­æ”¾å™¨ */
        .audio-player {
            background: rgba(255, 255, 255, 0.95);
            border: 1px solid rgba(0, 0, 0, 0.1);
            border-radius: 12px;
            padding: 16px;
            margin: 12px 0;
        }
        
        .audio-controls {
            display: flex;
            align-items: center;
            gap: 12px;
        }
        
        .play-btn {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: linear-gradient(135deg, #10b981 0%, #059669 100%);
            color: white;
            border: none;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: transform 0.2s ease;
        }
        
        .play-btn:hover {
            transform: scale(1.05);
        }
        
        .progress-bar {
            flex: 1;
            height: 4px;
            background: rgba(0, 0, 0, 0.1);
            border-radius: 2px;
            cursor: pointer;
        }
        
        .progress-fill {
            height: 100%;
            background: linear-gradient(135deg, #10b981 0%, #059669 100%);
            border-radius: 2px;
            width: 0%;
            transition: width 0.1s ease;
        }
        
        /* è½¬å½•æ–‡æœ¬ */
        .transcript-item {
            background: rgba(255, 255, 255, 0.9);
            border: 1px solid rgba(0, 0, 0, 0.1);
            border-radius: 8px;
            padding: 12px;
            margin: 8px 0;
            cursor: pointer;
            transition: all 0.2s ease;
        }
        
        .transcript-item:hover {
            background: rgba(34, 197, 94, 0.05);
            border-color: rgba(34, 197, 94, 0.3);
        }
        
        .speaker-tag {
            display: inline-block;
            background: rgba(34, 197, 94, 0.1);
            color: #059669;
            padding: 2px 8px;
            border-radius: 12px;
            font-size: 12px;
            font-weight: 600;
            margin-right: 8px;
        }
        
        .timestamp {
            color: #6b7280;
            font-size: 12px;
            margin-left: 8px;
        }
        
        /* ä¼šè®®çºªè¦æ ·å¼ */
        .meeting-summary {
            background: linear-gradient(135deg, #f0fdf4 0%, #dcfce7 100%);
            border: 1px solid rgba(34, 197, 94, 0.2);
            border-radius: 12px;
            padding: 20px;
            margin: 16px 0;
        }
        
        .highlight {
            background: linear-gradient(135deg, #fef3c7 0%, #fde68a 100%);
            padding: 2px 4px;
            border-radius: 4px;
            font-weight: 600;
        }
    </style>
</head>
<body class="h-screen flex flex-col">
    <!-- é¡µé¢å®¹å™¨ -->
    <div class="flex-1 flex flex-col w-full overflow-hidden">
        <!-- èŠå¤©å¤´éƒ¨ -->
        <div class="liquid-glass-strong rounded-t-lg p-4 flex items-center justify-between">
            <div class="flex items-center">
                <img src="/asset/avatar2.png" 
                     alt="ä¼šè®®åŠ©æ‰‹" class="w-12 h-12 rounded-full mr-4 object-cover">
                <div>
                    <h3 class="text-lg font-semibold text-gray-800">æ‚¨å¥½ï¼Œæˆ‘æ˜¯AIä¼šè®®åŠ©æ‰‹</h3>
                    <p class="text-sm text-gray-500">å·¥å·A0002 Â· æœ‰ä»€ä¹ˆå¯ä»¥å¸®åˆ°æ‚¨</p>
                </div>
            </div>
            <button onclick="clearChat()" class="liquid-glass floating-button rounded-lg px-4 py-2 text-sm font-medium text-gray-700 specular-highlight">
                æ–°å»ºä¼šè¯
            </button>
        </div>
        
        <!-- æ¶ˆæ¯åŒºåŸŸ -->
        <div id="messages-container" class="flex-1 liquid-glass-strong p-6 overflow-y-auto">
            <!-- åŠ©æ‰‹ä»‹ç»æ¶ˆæ¯ -->
            <div class="message-bubble assistant-message p-4 mb-4">
                <div class="prose prose-sm max-w-none text-gray-700 mb-4">
                    <p class="mb-3">æˆ‘èƒ½å¤Ÿå°†æ‚¨çš„ä¼šè®®å½•éŸ³è½¬ä¸ºæ–‡å­—è®°å½•ï¼Œè‡ªåŠ¨ç”Ÿæˆä¼šè®®çºªè¦ï¼Œè®©æ‚¨ä¸“æ³¨äºä¼šè®®å†…å®¹ï¼Œå‘Šåˆ«æ‰‹å·¥è®°å½•çš„çƒ¦æ¼ã€‚</p>
                    <p class="mb-3">æˆ‘æ”¯æŒ<span class="font-semibold text-green-600">è¯­éŸ³è¯†åˆ«è½¬å†™</span>ã€<span class="font-semibold text-green-600">è¯´è¯äººè¯†åˆ«</span>å’Œ<span class="font-semibold text-green-600">æ™ºèƒ½çºªè¦ç”Ÿæˆ</span>ã€‚</p>
                    <p class="text-sm text-gray-600">ğŸ¯ <strong>æ ¸å¿ƒåŠŸèƒ½ï¼š</strong>è¯­éŸ³è½¬æ–‡å­—ï¼ˆä¸å¼ºç­”æœºåˆ¶ï¼‰ã€è‡ªåŠ¨åˆ†è§’è‰²ã€ä¼šè®®çºªè¦ç”Ÿæˆã€å…³é”®ä¿¡æ¯æå–</p>
                </div>
                <p class="text-gray-700 font-medium">è¯·å…ˆä¸Šä¼ æ‚¨çš„ä¼šè®®å½•éŸ³æ–‡ä»¶ï¼š</p>
            </div>
            
            <!-- éŸ³é¢‘ä¸Šä¼ åŒºåŸŸ -->
            <div id="upload-section" class="mb-6">
                <div class="upload-area" id="upload-area" onclick="triggerFileUpload()">
                    <div class="text-center py-8">
                        <div class="w-16 h-16 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-4">
                            <svg class="w-8 h-8 text-green-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"></path>
                            </svg>
                        </div>
                        <h3 class="text-lg font-semibold text-gray-800 mb-2">ä¸Šä¼ ä¼šè®®å½•éŸ³æ–‡ä»¶</h3>
                        <p class="text-gray-600 mb-4">æ”¯æŒ MP3ã€WAVã€M4A æ ¼å¼ï¼Œæœ€å¤§æ”¯æŒ 200MB</p>
                        <div class="flex items-center justify-center space-x-4 text-sm text-gray-500">
                            <span class="flex items-center">
                                <svg class="w-4 h-4 mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"></path>
                                </svg>
                                å®‰å…¨åŠ å¯†
                            </span>
                            <span class="flex items-center">
                                <svg class="w-4 h-4 mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z"></path>
                                </svg>
                                å¿«é€Ÿå¤„ç†
                            </span>
                            <span class="flex items-center">
                                <svg class="w-4 h-4 mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                                </svg>
                                98%å‡†ç¡®ç‡
                            </span>
                        </div>
                        <button class="mt-4 bg-green-500 text-white px-6 py-2 rounded-lg hover:bg-green-600 transition-colors">
                            é€‰æ‹©æ–‡ä»¶
                        </button>
                        <p class="text-xs text-gray-400 mt-2">æˆ–ç›´æ¥æ‹–æ‹½æ–‡ä»¶åˆ°æ­¤åŒºåŸŸ</p>
                    </div>
                </div>
                <input type="file" id="audio-file-input" accept="audio/*" style="display: none;" onchange="handleFileUpload(event)">
            </div>
            
            <!-- ç¤ºä¾‹æ–‡ä»¶ -->
            <div id="sample-section" class="mb-6">
                <p class="text-sm font-medium text-gray-700 mb-3">ğŸ“ æˆ–è€…è¯•è¯•æˆ‘ä»¬çš„ç¤ºä¾‹æ–‡ä»¶ï¼š</p>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-3">
                    <div class="feature-card specular-highlight" onclick="loadSampleAudio('è‘£äº‹ä¼šä¾‹ä¼š')">
                        <div class="flex items-center">
                            <div class="w-8 h-8 bg-blue-100 rounded-lg flex items-center justify-center mr-3">
                                <span class="text-blue-600 text-sm">ğŸ¢</span>
                            </div>
                            <div>
                                <h4 class="font-medium text-gray-800">è‘£äº‹ä¼šä¾‹ä¼š</h4>
                                <p class="text-xs text-gray-600">4äººå‚ä¼š â€¢ 45åˆ†é’Ÿ</p>
                            </div>
                        </div>
                    </div>
                    
                    <div class="feature-card specular-highlight" onclick="loadSampleAudio('é¡¹ç›®è¯„å®¡ä¼š')">
                        <div class="flex items-center">
                            <div class="w-8 h-8 bg-purple-100 rounded-lg flex items-center justify-center mr-3">
                                <span class="text-purple-600 text-sm">ğŸ’¼</span>
                            </div>
                            <div>
                                <h4 class="font-medium text-gray-800">é¡¹ç›®è¯„å®¡ä¼š</h4>
                                <p class="text-xs text-gray-600">6äººå‚ä¼š â€¢ 62åˆ†é’Ÿ</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- è¾“å…¥åŒºåŸŸ -->
        <div class="liquid-glass-strong rounded-b-lg p-4">
            <div class="flex items-end space-x-3">
                <div class="flex-1">
                    <input type="text" 
                           id="message-input"
                           placeholder="ä¸Šä¼ éŸ³é¢‘åå¯åœ¨æ­¤æœç´¢ä¼šè®®å†…å®¹æˆ–æé—®..."
                           class="w-full chat-input"
                           onkeypress="if(event.key==='Enter') sendMessage()">
                </div>
                <button onclick="sendMessage()" 
                        class="liquid-glass floating-button rounded-lg p-3 specular-highlight bg-green-500 text-white">
                    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 19l9 2-9-18-9 18 9-2zm0 0v-8"></path>
                    </svg>
                </button>
            </div>
        </div>
    </div>

    <!-- éŸ³é¢‘æ¥æºå¼¹çª— -->
    <div id="source-modal" class="modal-overlay">
        <div class="modal-content">
            <div class="flex items-center justify-between p-6 border-b border-gray-200/50">
                <h3 class="text-lg font-semibold text-gray-800">éŸ³é¢‘æ¥æºè¯¦æƒ…</h3>
                <button onclick="closeSourceModal()" class="text-gray-500 hover:text-gray-700">
                    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                    </svg>
                </button>
            </div>
            
            <div class="p-6 overflow-y-auto max-h-96">
                <div class="mb-6">
                    <h4 class="font-semibold text-gray-800 mb-2">ğŸµ éŸ³é¢‘ä¿¡æ¯</h4>
                    <div class="bg-gray-50 rounded-lg p-4">
                        <p class="text-sm text-gray-600 mb-2">
                            <span class="font-medium">æ–‡ä»¶åç§°ï¼š</span>
                            <span id="audio-filename">-</span>
                        </p>
                        <p class="text-sm text-gray-600 mb-2">
                            <span class="font-medium">æ—¶é—´ä½ç½®ï¼š</span>
                            <span id="audio-timestamp">-</span>
                        </p>
                        <p class="text-sm text-gray-600">
                            <span class="font-medium">è¯†åˆ«å‡†ç¡®ç‡ï¼š</span>
                            <span id="audio-accuracy" class="text-green-600">-</span>
                        </p>
                    </div>
                </div>
                
                <div class="mb-6">
                    <h4 class="font-semibold text-gray-800 mb-2">ğŸ“ è½¬å½•æ–‡æœ¬</h4>
                    <div class="bg-blue-50 rounded-lg p-4">
                        <div id="transcript-content" class="text-sm text-gray-700 leading-relaxed">
                            -
                        </div>
                    </div>
                </div>
                
                <div>
                    <h4 class="font-semibold text-gray-800 mb-2">ğŸ‘¥ è¯´è¯äººä¿¡æ¯</h4>
                    <div id="speaker-info" class="flex flex-wrap gap-2">
                        <!-- è¯´è¯äººæ ‡ç­¾å°†åŠ¨æ€ç”Ÿæˆ -->
                    </div>
                </div>
            </div>
            
            <div class="flex items-center justify-between p-6 border-t border-gray-200/50">
                <div class="text-sm text-gray-500">
                    è¯­éŸ³è¯†åˆ«å¼•æ“ï¼šDeepSpeech v3.2
                </div>
                <button onclick="closeSourceModal()" class="bg-green-500 text-white rounded-lg px-4 py-2 text-sm font-medium hover:bg-green-600 transition-colors">
                    ç¡®å®š
                </button>
            </div>
        </div>
    </div>

    <script>
        let conversationHistory = [];
        let isTyping = false;
        let currentContext = [];
        let currentAudioData = null;

        // æ¨¡æ‹Ÿä¼šè®®æ•°æ®
        const meetingData = {
            audioFile: "è‘£äº‹ä¼šå­£åº¦ä¾‹ä¼š_20241215.mp3",
            duration: "45:23",
            participants: ["å¼ æ€»", "æä¸»ä»»", "ç‹ç»ç†", "åˆ˜åŠ©ç†"],
            transcript: [
                {
                    speaker: "å¼ æ€»",
                    time: "00:02:15",
                    text: "å„ä½å¥½ï¼Œä»Šå¤©ä¸»è¦è®¨è®ºQ4çš„ä¸šç»©æƒ…å†µå’Œæ˜å¹´çš„é¢„ç®—è§„åˆ’ã€‚è¯·æä¸»ä»»å…ˆæ±‡æŠ¥ä¸€ä¸‹è´¢åŠ¡æ•°æ®ã€‚",
                    accuracy: 98
                },
                {
                    speaker: "æä¸»ä»»", 
                    time: "00:02:45",
                    text: "å¥½çš„å¼ æ€»ã€‚æ ¹æ®æœ€æ–°ç»Ÿè®¡ï¼ŒQ4è¥æ”¶åŒæ¯”å¢é•¿15.2%ï¼Œå‡€åˆ©æ¶¦å¢é•¿12.8%ï¼Œæ•´ä½“è¡¨ç°è‰¯å¥½ã€‚",
                    accuracy: 96
                },
                {
                    speaker: "ç‹ç»ç†",
                    time: "00:03:20", 
                    text: "å¸‚åœºéƒ¨è¿™è¾¹ï¼Œæ–°å®¢æˆ·è·å–ç‡æå‡äº†23%ï¼Œå®¢æˆ·æ»¡æ„åº¦è¾¾åˆ°äº†94.5%ã€‚",
                    accuracy: 97
                },
                {
                    speaker: "åˆ˜åŠ©ç†",
                    time: "00:04:10",
                    text: "éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œæ˜å¹´Q1æœ‰å‡ ä¸ªé‡è¦çš„åˆè§„æ£€æŸ¥èŠ‚ç‚¹ï¼Œå»ºè®®æå‰å‡†å¤‡ç›¸å…³ææ–™ã€‚",
                    accuracy: 95
                }
            ],
            summary: {
                topic: "Q4ä¸šç»©æ€»ç»“åŠæ˜å¹´é¢„ç®—è§„åˆ’ä¼šè®®",
                keyPoints: [
                    "Q4è¥æ”¶åŒæ¯”å¢é•¿15.2%ï¼Œå‡€åˆ©æ¶¦å¢é•¿12.8%",
                    "æ–°å®¢æˆ·è·å–ç‡æå‡23%ï¼Œå®¢æˆ·æ»¡æ„åº¦94.5%", 
                    "æ˜å¹´Q1é¢ä¸´é‡è¦åˆè§„æ£€æŸ¥"
                ],
                actionItems: [
                    "æä¸»ä»»ï¼šå®Œå–„Q4è´¢åŠ¡æŠ¥å‘Šï¼Œ12æœˆ20æ—¥å‰æäº¤",
                    "ç‹ç»ç†ï¼šåˆ¶å®šæ˜å¹´å®¢æˆ·æ‹“å±•è®¡åˆ’ï¼Œ12æœˆ25æ—¥å‰å®Œæˆ",
                    "åˆ˜åŠ©ç†ï¼šå‡†å¤‡Q1åˆè§„æ£€æŸ¥ææ–™ï¼Œ1æœˆ10æ—¥å‰å®Œæˆ"
                ],
                nextMeeting: "2024å¹´1æœˆ5æ—¥ ä¸‹åˆ2:00"
            }
        };

        // Toastæç¤ºå‡½æ•°
        function showToast(message, type = 'info') {
            const toast = document.createElement('div');
            toast.className = `toast ${type}`;
            toast.innerHTML = `
                <div class="flex items-center">
                    <div class="mr-3">
                        ${type === 'success' ? 'âœ…' : type === 'error' ? 'âŒ' : 'â„¹ï¸'}
                    </div>
                    <div>
                        <div class="font-medium text-gray-800">${message}</div>
                    </div>
                    <button onclick="this.parentElement.parentElement.remove()" class="ml-4 text-gray-500 hover:text-gray-700">
                        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                        </svg>
                    </button>
                </div>
            `;
            
            document.body.appendChild(toast);
            setTimeout(() => toast.classList.add('show'), 100);
            setTimeout(() => {
                toast.classList.remove('show');
                setTimeout(() => toast.remove(), 300);
            }, 3000);
        }

        // ç®€å•çš„Markdownæ¸²æŸ“å™¨
        function renderMarkdown(text) {
            return text
                .replace(/\*\*(.*?)\*\*/g, '<strong>$1</strong>')
                .replace(/\*(.*?)\*/g, '<em>$1</em>')
                .replace(/^### (.*$)/gim, '<h3 class="text-lg font-semibold text-gray-800 mt-4 mb-2">$1</h3>')
                .replace(/^## (.*$)/gim, '<h2 class="text-xl font-semibold text-gray-800 mt-4 mb-3">$1</h2>')
                .replace(/^# (.*$)/gim, '<h1 class="text-2xl font-bold text-gray-800 mt-4 mb-3">$1</h1>')
                .replace(/^- (.*$)/gim, '<li class="ml-4">$1</li>')
                .replace(/^(\d+)\. (.*$)/gim, '<li class="ml-4 list-decimal">$2</li>')
                .replace(/\n/g, '<br>');
        }

        // æ·»åŠ æ¶ˆæ¯
        function addMessage(sender, content, source = null, mermaidCode = null, audioData = null) {
            const container = document.getElementById('messages-container');
            const messageDiv = document.createElement('div');
            const messageId = 'msg_' + Date.now();
            messageDiv.className = `message-bubble ${sender}-message p-4 mb-4`;
            messageDiv.id = messageId;
            
            if (sender === 'assistant') {
                let messageHTML = `<div class="prose prose-sm max-w-none">${renderMarkdown(content)}</div>`;
                
                // æ·»åŠ éŸ³é¢‘æ’­æ”¾å™¨
                audioData=audioData||meetingData;
                if (audioData) {
                    messageHTML += `
                        <div class="audio-player">
                            <div class="audio-controls">
                                <button class="play-btn" onclick="toggleAudio()">
                                    <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 24 24">
                                        <path d="M8 5v14l11-7z"/>
                                    </svg>
                                </button>
                                <div class="progress-bar" onclick="seekAudio(event)">
                                    <div class="progress-fill" id="progress-${messageId}"></div>
                                </div>
                                <span class="text-sm text-gray-600">${audioData.duration}</span>
                            </div>
                            <div class="mt-2 text-sm text-gray-600">
                                <span class="font-medium">${audioData.filename}</span>
                                <span class="ml-2">å‚ä¸äººå‘˜ï¼š${audioData.participants.join('ã€')}</span>
                            </div>
                        </div>`;
                }
                
                // æ·»åŠ è½¬å½•æ–‡æœ¬
                if (audioData && audioData.transcript) {
                    messageHTML += `<div class="mt-4">`;
                    audioData.transcript.forEach(item => {
                        messageHTML += `
                            <div class="transcript-item" onclick="jumpToAudio('${item.time}')">
                                <span class="speaker-tag">${item.speaker}</span>
                                <span class="timestamp">${item.time}</span>
                                <div class="mt-1 text-sm">${item.text}</div>
                            </div>`;
                    });
                    messageHTML += `</div>`;
                }
                
                // æ·»åŠ Mermaidæµç¨‹å›¾
                // if (mermaidCode) {
                //     const mermaidId = 'mermaid_' + Date.now();
                //     messageHTML += `
                //         <div class="mermaid-container mt-4">
                //             <div class="text-sm font-medium text-gray-700 mb-3">ğŸ“Š å¤„ç†æµç¨‹ï¼š</div>
                //             <div class="mermaid" id="${mermaidId}">${mermaidCode}</div>
                //         </div>`;
                // }
                
                if (source) {
                    messageHTML += `
                        <div class="source-reference mt-3" onclick="showSourceDetail('${messageId}')">
                            <div class="flex items-center text-sm">
                                <svg class="w-4 h-4 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15.536 11.293l-2.829 2.829a1 1 0 01-1.414 0L8.464 11.293M12 4v12m0 0l-3-3m3 3l3-3"></path>
                                </svg>
                                <span class="text-green-700">æŸ¥çœ‹éŸ³é¢‘æ¥æºï¼š${source.position}</span>
                            </div>
                        </div>`;
                }
                
                // æ·»åŠ äº¤äº’æŒ‰é’®
                messageHTML += `
                    <div class="message-actions">
                        <button class="action-btn like" onclick="likeMessage('${messageId}')">
                            <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M14 10h4.764a2 2 0 011.789 2.894l-3.5 7A2 2 0 0115.263 21h-4.017c-.163 0-.326-.02-.485-.06L7 20m7-10V5a2 2 0 00-2-2h-.095c-.5 0-.905.405-.905.905 0 .714-.211 1.412-.608 2.006L9 9m5 1v10M4 12v8a2 2 0 002 2h2m-6-10V9a2 2 0 012-2h2m2 5a2 2 0 012-2h2a2 2 0 012 2m-6 9l2 2 4-4"></path>
                            </svg>
                            <span>èµ</span>
                        </button>
                        <button class="action-btn dislike" onclick="dislikeMessage('${messageId}')">
                            <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 14H5.236a2 2 0 01-1.789-2.894l3.5-7A2 2 0 018.736 3h4.018c.163 0 .326.02.485.06L17 4m-7 10v2a2 2 0 002 2h.095c.5 0 .905-.405.905-.905 0-.714.211-1.412.608-2.006L15 15M10 14l-2-2m6-6v8a2 2 0 01-2 2h-2m6-10V4a2 2 0 00-2-2h-2m-6 5a2 2 0 00-2-2H4a2 2 0 00-2 2m10 9l-2-2-4 4"></path>
                            </svg>
                            <span>è¸©</span>
                        </button>
                        <button class="action-btn" onclick="editAnswer('${messageId}')">
                            <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"></path>
                            </svg>
                            <span>ç¼–è¾‘</span>
                        </button>
                        <button class="action-btn" onclick="getAssistance('${messageId}')">
                            <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8.228 9c.549-1.165 2.03-2 3.772-2 2.21 0 4 1.343 4 3 0 1.4-1.278 2.575-3.006 2.907-.542.104-.994.54-.994 1.093m0 3h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                            </svg>
                            <span>è¾…åŠ©</span>
                        </button>
                    </div>`;
                
                messageDiv.innerHTML = messageHTML;
                
                // å­˜å‚¨sourceå’ŒaudioDataåˆ°å…ƒç´ ä¸Š
                if (source) {
                    messageDiv.setAttribute('data-source', JSON.stringify(source));
                }
                if (audioData) {
                    messageDiv.setAttribute('data-audio', JSON.stringify(audioData));
                }
            } else {
                messageDiv.textContent = content;
            }
            
            container.appendChild(messageDiv);
            container.scrollTop = container.scrollHeight;
            
            // å¦‚æœæœ‰Mermaidå›¾è¡¨ï¼Œé‡æ–°æ¸²æŸ“
            if (mermaidCode) {
                setTimeout(() => {
                    mermaid.init();
                }, 100);
            }
        }

        // è§¦å‘æ–‡ä»¶ä¸Šä¼ 
        function triggerFileUpload() {
            document.getElementById('audio-file-input').click();
        }

        // å¤„ç†æ–‡ä»¶ä¸Šä¼ 
        function handleFileUpload(event) {
            const file = event.target.files[0];
            if (file) {
                processAudioFile(file);
            }
        }

        // åŠ è½½ç¤ºä¾‹éŸ³é¢‘
        function loadSampleAudio(sampleName) {
            showToast(`æ­£åœ¨åŠ è½½ç¤ºä¾‹æ–‡ä»¶ï¼š${sampleName}`, 'info');
            
            // æ¨¡æ‹Ÿä¸åŒçš„ç¤ºä¾‹æ•°æ®
            let sampleData = meetingData;
            if (sampleName === 'é¡¹ç›®è¯„å®¡ä¼š') {
                sampleData = {
                    ...meetingData,
                    audioFile: "äº§å“è¯„å®¡ä¼šè®®_20241210.mp3",
                    duration: "62:18",
                    participants: ["äº§å“æ€»ç›‘", "æŠ€æœ¯è´Ÿè´£äºº", "UIè®¾è®¡å¸ˆ", "æµ‹è¯•ç»ç†", "é¡¹ç›®ç»ç†", "ä¸šåŠ¡ä»£è¡¨"]
                };
            }
            
            setTimeout(() => {
                processAudioFile(null, sampleData);
            }, 1500);
        }

        // å¤„ç†éŸ³é¢‘æ–‡ä»¶
        function processAudioFile(file, sampleData = null) {
            // éšè—ä¸Šä¼ åŒºåŸŸå’Œç¤ºä¾‹åŒºåŸŸ
            document.getElementById('upload-section').style.display = 'none';
            document.getElementById('sample-section').style.display = 'none';
            
            const fileName = file ? file.name : (sampleData ? sampleData.audioFile : 'ç¤ºä¾‹æ–‡ä»¶.mp3');
            
            // æ˜¾ç¤ºå¤„ç†è¿›åº¦
            addMessage('user', `å·²ä¸Šä¼ æ–‡ä»¶ï¼š${fileName}`);
            
            showTypingIndicator();
            
            setTimeout(() => {
                hideTypingIndicator();
                
                const response = `ğŸ‰ **éŸ³é¢‘æ–‡ä»¶å¤„ç†å®Œæˆï¼**

**ğŸ“Š å¤„ç†ç»“æœï¼š**
- **æ–‡ä»¶åç§°**ï¼š${fileName}
- **å¤„ç†æ—¶é•¿**ï¼š${sampleData ? sampleData.duration : 'è®¡ç®—ä¸­...'}
- **å‚ä¸äººå‘˜**ï¼š${sampleData ? sampleData.participants.length : 'è¯†åˆ«ä¸­...'}äºº
- **è¯†åˆ«å‡†ç¡®ç‡**ï¼š97.3%

éŸ³é¢‘æ–‡ä»¶å·²æˆåŠŸå¤„ç†ï¼Œç°åœ¨æ‚¨å¯ä»¥é€‰æ‹©è¦æ‰§è¡Œçš„æ“ä½œï¼š`;

                const audioSource = {
                    filename: fileName,
                    position: "å®Œæ•´ä¼šè®®è½¬å½•",
                    accuracy: "97.3%",
                    transcript: sampleData ? sampleData.transcript[0].text : "è½¬å½•æ–‡æœ¬é¢„è§ˆ...",
                    speakers: sampleData ? sampleData.participants : ["è¯´è¯äºº1", "è¯´è¯äºº2"]
                };

                addMessage('assistant', response, audioSource, sampleData || meetingData);
                
                // æ˜¾ç¤º"çŒœä½ æƒ³åš"é€‰é¡¹
                showActionOptions();
            }, 3000);
        }

        // æ˜¾ç¤ºæ“ä½œé€‰é¡¹
        function showActionOptions() {
            const container = document.getElementById('messages-container');
            
            const optionsDiv = document.createElement('div');
            optionsDiv.className = 'mb-6';
            optionsDiv.innerHTML = `
                <div class="message-bubble assistant-message p-4 mb-4">
                    <p class="text-gray-700 font-medium mb-4">ğŸ’¡ çŒœæ‚¨æƒ³è¦ï¼š</p>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-3">
                        <div class="feature-card specular-highlight" onclick="performAction('transcript')">
                            <div class="flex items-start">
                                <div class="w-8 h-8 bg-green-100 rounded-lg flex items-center justify-center mr-3 flex-shrink-0">
                                    <span class="text-green-600 text-sm">ğŸ“</span>
                                </div>
                                <div>
                                    <h4 class="font-medium text-gray-800 mb-1">æŸ¥çœ‹å®Œæ•´è½¬å½•æ–‡æœ¬</h4>
                                    <p class="text-sm text-gray-600">é€å­—é€å¥çš„ä¼šè®®è®°å½•ï¼Œæ”¯æŒè¯´è¯äººè¯†åˆ«</p>
                                </div>
                            </div>
                        </div>
                        
                        <div class="feature-card specular-highlight" onclick="performAction('minutes')">
                            <div class="flex items-start">
                                <div class="w-8 h-8 bg-blue-100 rounded-lg flex items-center justify-center mr-3 flex-shrink-0">
                                    <span class="text-blue-600 text-sm">ğŸ“„</span>
                                </div>
                                <div>
                                    <h4 class="font-medium text-gray-800 mb-1">ç”Ÿæˆä¼šè®®çºªè¦</h4>
                                    <p class="text-sm text-gray-600">æ™ºèƒ½æå–å…³é”®ä¿¡æ¯ï¼Œç”Ÿæˆæ ‡å‡†çºªè¦</p>
                                </div>
                            </div>
                        </div>
                        
                        <div class="feature-card specular-highlight" onclick="performAction('summary')">
                            <div class="flex items-start">
                                <div class="w-8 h-8 bg-purple-100 rounded-lg flex items-center justify-center mr-3 flex-shrink-0">
                                    <span class="text-purple-600 text-sm">ğŸ“‹</span>
                                </div>
                                <div>
                                    <h4 class="font-medium text-gray-800 mb-1">æå–å…³é”®ä¿¡æ¯</h4>
                                    <p class="text-sm text-gray-600">è‡ªåŠ¨è¯†åˆ«é‡ç‚¹ã€å†³è®®å’Œå¾…åŠäº‹é¡¹</p>
                                </div>
                            </div>
                        </div>
                        
                        <div class="feature-card specular-highlight" onclick="performAction('search')">
                            <div class="flex items-start">
                                <div class="w-8 h-8 bg-orange-100 rounded-lg flex items-center justify-center mr-3 flex-shrink-0">
                                    <span class="text-orange-600 text-sm">ğŸ”</span>
                                </div>
                                <div>
                                    <h4 class="font-medium text-gray-800 mb-1">æœç´¢ä¼šè®®å†…å®¹</h4>
                                    <p class="text-sm text-gray-600">å¿«é€Ÿå®šä½ç‰¹å®šè¯é¢˜æˆ–å‘è¨€äººå†…å®¹</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            `;
            
            container.appendChild(optionsDiv);
            container.scrollTop = container.scrollHeight;
        }

        // æ‰§è¡Œé€‰å®šçš„æ“ä½œ
        function performAction(action) {
            // éšè—æ“ä½œé€‰é¡¹
            const optionsDiv = document.querySelector('.message-bubble:last-child').parentElement;
            if (optionsDiv) optionsDiv.style.display = 'none';
            
            let userAction = '';
            
            switch (action) {
                case 'transcript':
                    userAction = 'è¯·æ˜¾ç¤ºå®Œæ•´çš„ä¼šè®®è½¬å½•æ–‡æœ¬';
                    break;
                case 'minutes':
                    userAction = 'è¯·ç”Ÿæˆä¼šè®®çºªè¦';
                    break;
                case 'summary':
                    userAction = 'è¯·æå–å…³é”®ä¿¡æ¯å’Œå†³è®®äº‹é¡¹';
                    break;
                case 'search':
                    userAction = 'æˆ‘æƒ³æœç´¢ä¼šè®®ä¸­çš„ç‰¹å®šå†…å®¹';
                    break;
            }
            
            addMessage('user', userAction);
            
            setTimeout(() => {
                showTypingIndicator();
                setTimeout(() => {
                    hideTypingIndicator();
                    handleActionResponse(action);

                    // æ˜¾ç¤º"çŒœä½ æƒ³åš"é€‰é¡¹
                showActionOptions();
                }, 2000);
            }, 500);
        }

        // å¤„ç†æ“ä½œå“åº”
        function handleActionResponse(action) {
            switch (action) {
                case 'transcript':
                    showCompleteTranscript();
                    break;
                case 'minutes':
                    generateMeetingMinutes();
                    break;
                case 'summary':
                    extractKeyInformation();
                    break;
                case 'search':
                    enableSearchMode();
                    break;
            }
        }

        // æ˜¾ç¤ºå®Œæ•´è½¬å½•æ–‡æœ¬
        function showCompleteTranscript() {
            const transcriptContent = `**ğŸ“ å®Œæ•´ä¼šè®®è½¬å½•æ–‡æœ¬**

ä»¥ä¸‹æ˜¯å®Œæ•´çš„ä¼šè®®å½•éŸ³è½¬å½•ï¼Œå·²è‡ªåŠ¨è¯†åˆ«è¯´è¯äººå¹¶æ ‡æ³¨æ—¶é—´ï¼š

**ä¼šè®®åŸºæœ¬ä¿¡æ¯ï¼š**
- ä¼šè®®åç§°ï¼šè‘£äº‹ä¼šå­£åº¦ä¾‹ä¼š
- å½•éŸ³æ—¶é•¿ï¼š45åˆ†23ç§’
- å‚ä¼šäººå‘˜ï¼š4äºº
- è½¬å½•å‡†ç¡®ç‡ï¼š97.3%`;

            addMessage('assistant', transcriptContent, null, meetingData);
            showToast('è½¬å½•æ–‡æœ¬å·²ç”Ÿæˆï¼Œç‚¹å‡»ä»»æ„æ®µè½å¯è·³è½¬åˆ°å¯¹åº”éŸ³é¢‘ä½ç½®', 'success');
        }

        // ç”Ÿæˆä¼šè®®çºªè¦
        function generateMeetingMinutes() {
            const minutesContent = `**èµåŒç§‘æŠ€è‘£äº‹ä¼šå­£åº¦ä¾‹ä¼šçºªè¦**

**ğŸ“… ä¼šè®®åŸºæœ¬ä¿¡æ¯**
- **ä¼šè®®æ—¶é—´**ï¼š2024å¹´12æœˆ15æ—¥ 14:00-14:45
- **ä¼šè®®åœ°ç‚¹**ï¼šæ€»éƒ¨ä¼šè®®å®¤A
- **ä¸»æŒäºº**ï¼šå¼ æ€»
- **å‚ä¼šäººå‘˜**ï¼šå¼ æ€»ã€æä¸»ä»»ã€ç‹ç»ç†ã€åˆ˜åŠ©ç†
- **è®°å½•äºº**ï¼šAIä¼šè®®åŠ©æ‰‹

**ğŸ“‹ ä¼šè®®ä¸»è¦å†…å®¹**

**ä¸€ã€Q4ä¸šç»©æ±‡æŠ¥**
æä¸»ä»»æ±‡æŠ¥äº†ç¬¬å››å­£åº¦è´¢åŠ¡æ•°æ®ï¼š
- Q4è¥æ”¶åŒæ¯”å¢é•¿**15.2%**
- å‡€åˆ©æ¶¦å¢é•¿**12.8%** 
- æ•´ä½“ä¸šç»©è¡¨ç°è‰¯å¥½ï¼Œè¶…é¢„æœŸå®Œæˆå¹´åº¦ç›®æ ‡

**äºŒã€å¸‚åœºæ‹“å±•æƒ…å†µ**
ç‹ç»ç†æ±‡æŠ¥å¸‚åœºéƒ¨å·¥ä½œæˆæœï¼š
- æ–°å®¢æˆ·è·å–ç‡æå‡**23%**
- å®¢æˆ·æ»¡æ„åº¦è¾¾åˆ°**94.5%**
- å“ç‰Œå½±å“åŠ›æŒç»­æå‡

**ä¸‰ã€åˆè§„é£é™©æé†’**
åˆ˜åŠ©ç†æé†’æ˜å¹´åˆè§„è¦ç‚¹ï¼š
- æ˜å¹´Q1å°†é¢ä¸´é‡è¦åˆè§„æ£€æŸ¥
- éœ€æå‰å‡†å¤‡ç›¸å…³åˆè§„ææ–™
- å»ºè®®åŠ å¼ºå†…æ§ä½“ç³»å»ºè®¾

**âœ… ä¼šè®®å†³è®®äº‹é¡¹**
1. æ‰¹å‡†Q4è´¢åŠ¡æŠ¥å‘Šï¼ŒåŒæ„æäº¤è‘£äº‹ä¼šå®¡è®®
2. é€šè¿‡æ˜å¹´å®¢æˆ·æ‹“å±•æˆ˜ç•¥è§„åˆ’
3. åŠ å¼ºåˆè§„é£é™©é˜²æ§ä½“ç³»å»ºè®¾

**ğŸ“ å¾…åŠäº‹é¡¹åŠè´£ä»»äºº**
1. **æä¸»ä»»**ï¼šå®Œå–„Q4è´¢åŠ¡æŠ¥å‘Šï¼Œæˆªæ­¢æ—¶é—´ï¼š12æœˆ20æ—¥
2. **ç‹ç»ç†**ï¼šåˆ¶å®šæ˜å¹´å®¢æˆ·æ‹“å±•è®¡åˆ’ï¼Œæˆªæ­¢æ—¶é—´ï¼š12æœˆ25æ—¥  
3. **åˆ˜åŠ©ç†**ï¼šå‡†å¤‡Q1åˆè§„æ£€æŸ¥ææ–™ï¼Œæˆªæ­¢æ—¶é—´ï¼š1æœˆ10æ—¥

**ğŸ“… ä¸‹æ¬¡ä¼šè®®å®‰æ’**
æ—¶é—´ï¼š2024å¹´1æœˆ5æ—¥ ä¸‹åˆ2:00
è®®é¢˜ï¼šå¹´åº¦æ€»ç»“åŠæ–°å¹´è§„åˆ’

---
*æœ¬çºªè¦ç”±AIä¼šè®®åŠ©æ‰‹è‡ªåŠ¨ç”Ÿæˆï¼Œå…³é”®ä¿¡æ¯ä¸¢å¤±ç‡ï¼š2.1%*`;

            addMessage('assistant', minutesContent);
            showToast('ä¼šè®®çºªè¦å·²ç”Ÿæˆå®Œæˆï¼å¯ä¸‹è½½Wordæˆ–PDFæ ¼å¼', 'success');
        }

        // æå–å…³é”®ä¿¡æ¯
        function extractKeyInformation() {
            const summaryContent = `**ğŸ¯ ä¼šè®®å…³é”®ä¿¡æ¯æå–**

**ğŸ“Š é‡è¦æ•°æ®æŒ‡æ ‡ï¼š**
- Q4è¥æ”¶å¢é•¿ï¼š**+15.2%**
- å‡€åˆ©æ¶¦å¢é•¿ï¼š**+12.8%**
- æ–°å®¢æˆ·è·å–ç‡ï¼š**+23%**
- å®¢æˆ·æ»¡æ„åº¦ï¼š**94.5%**

**ğŸ”‘ å…³é”®å†³è®®ï¼š**
1. **è´¢åŠ¡æŠ¥å‘Šæ‰¹å‡†** - æäº¤è‘£äº‹ä¼šå®¡è®®
2. **æˆ˜ç•¥è§„åˆ’é€šè¿‡** - æ˜å¹´å®¢æˆ·æ‹“å±•è®¡åˆ’
3. **é£æ§ä½“ç³»åŠ å¼º** - åº”å¯¹åˆè§„æ£€æŸ¥

**ğŸ“… é‡è¦æ—¶é—´èŠ‚ç‚¹ï¼š**
- **12æœˆ20æ—¥**ï¼šè´¢åŠ¡æŠ¥å‘Šå®Œå–„ï¼ˆæä¸»ä»»è´Ÿè´£ï¼‰
- **12æœˆ25æ—¥**ï¼šæ‹“å±•è®¡åˆ’åˆ¶å®šï¼ˆç‹ç»ç†è´Ÿè´£ï¼‰
- **1æœˆ10æ—¥**ï¼šåˆè§„ææ–™å‡†å¤‡ï¼ˆåˆ˜åŠ©ç†è´Ÿè´£ï¼‰
- **1æœˆ5æ—¥**ï¼šä¸‹æ¬¡ä¼šè®®å®‰æ’

**âš ï¸ é£é™©æé†’ï¼š**
- æ˜å¹´Q1åˆè§„æ£€æŸ¥éœ€è¦é‡ç‚¹å…³æ³¨
- å»ºè®®æå‰1ä¸ªæœˆå¼€å§‹å‡†å¤‡ç›¸å…³ææ–™
- åŠ å¼ºå†…æ§ä½“ç³»å»ºè®¾è¿«åœ¨çœ‰ç«

**ğŸ’¼ éƒ¨é—¨è¡ŒåŠ¨è¦æ±‚ï¼š**
- **è´¢åŠ¡éƒ¨**ï¼šå¼ºåŒ–æ•°æ®å‡†ç¡®æ€§å’ŒåŠæ—¶æ€§
- **å¸‚åœºéƒ¨**ï¼šç»§ç»­ä¿æŒå®¢æˆ·æ‹“å±•ä¼˜åŠ¿
- **åˆè§„éƒ¨**ï¼šå…¨é¢æ¢³ç†é£é™©æ§åˆ¶ç‚¹`;

            addMessage('assistant', summaryContent);
            showToast('å…³é”®ä¿¡æ¯å·²æå–å®Œæˆï¼', 'success');
        }

        // å¯ç”¨æœç´¢æ¨¡å¼
        function enableSearchMode() {
            const searchContent = `**ğŸ” ä¼šè®®å†…å®¹æœç´¢åŠŸèƒ½å·²å¯ç”¨**

ç°åœ¨æ‚¨å¯ä»¥æœç´¢ä¼šè®®ä¸­çš„ä»»ä½•å†…å®¹ï¼š

**æœç´¢ç¤ºä¾‹ï¼š**
- æœç´¢ç‰¹å®šæ•°å­—ï¼š"15.2%" æˆ– "è¥æ”¶"
- æœç´¢å‘è¨€äººï¼š"å¼ æ€»è¯´äº†ä»€ä¹ˆ"
- æœç´¢è¯é¢˜ï¼š"å®¢æˆ·æ»¡æ„åº¦ç›¸å…³å†…å®¹"
- æœç´¢æ—¶é—´æ®µï¼š"å‰10åˆ†é’Ÿè®¨è®ºäº†ä»€ä¹ˆ"

**é«˜çº§æœç´¢ï¼š**
- æ”¯æŒæ¨¡ç³ŠåŒ¹é…å’Œè¯­ä¹‰æœç´¢
- è‡ªåŠ¨é«˜äº®æœç´¢ç»“æœ
- æä¾›éŸ³é¢‘æ—¶é—´ç‚¹è·³è½¬
- æ˜¾ç¤ºä¸Šä¸‹æ–‡ç›¸å…³å†…å®¹

è¯·åœ¨ä¸‹æ–¹è¾“å…¥æ¡†ä¸­è¾“å…¥æ‚¨è¦æœç´¢çš„å†…å®¹ï¼Œæˆ‘ä¼šä¸ºæ‚¨ç²¾ç¡®å®šä½ï¼`;

            addMessage('assistant', searchContent);
            showToast('æœç´¢æ¨¡å¼å·²å¯ç”¨ï¼Œè¯·åœ¨è¾“å…¥æ¡†ä¸­è¾“å…¥æœç´¢å…³é”®è¯', 'info');
        }

        // å¼€å§‹ä¼šè®®æ¼”ç¤ºï¼ˆä¿ç•™åŸæœ‰åŠŸèƒ½ä»¥é˜²è°ƒç”¨ï¼‰
        function startMeetingDemo() {
            loadSampleAudio('è‘£äº‹ä¼šä¾‹ä¼š');
        }

        // ç”Ÿæˆä¼šè®®çºªè¦æ¼”ç¤ºï¼ˆä¿ç•™åŸæœ‰åŠŸèƒ½ä»¥é˜²è°ƒç”¨ï¼‰
        function generateMinutesDemo() {
            performAction('minutes');
        }

        // å¤„ç†ç”¨æˆ·é—®é¢˜
        function askQuestion(question) {
            // éšè—åŠŸèƒ½å¡ç‰‡
            const featureCards = document.querySelectorAll('.feature-card');
            featureCards.forEach(card => {
                card.style.display = 'none';
            });
            
            addMessage('user', question);
            
            setTimeout(() => {
                showTypingIndicator();
                setTimeout(() => {
                    hideTypingIndicator();
                    
                    let response = '';
                    if (question.includes('å‡†ç¡®ç‡')) {
                        response = `**ğŸ¯ ä¼šè®®åŠ©æ‰‹å‡†ç¡®ç‡è¯´æ˜**

**è¯­éŸ³è½¬æ–‡å­—å‡†ç¡®ç‡ï¼š**
- **ä¸­æ–‡æ™®é€šè¯**ï¼š98.5%
- **è‹±æ–‡**ï¼š97.2%  
- **æ–¹è¨€è¯†åˆ«**ï¼š85-92%
- **å˜ˆæ‚ç¯å¢ƒ**ï¼š78-85%

**è¯´è¯äººè¯†åˆ«å‡†ç¡®ç‡ï¼š**
- **2-4äººä¼šè®®**ï¼š99.1%
- **5-8äººä¼šè®®**ï¼š96.8%
- **8äººä»¥ä¸Š**ï¼š92.3%

**å…³é”®ä¿¡æ¯æå–å‡†ç¡®ç‡ï¼š**
- **ä¼šè®®ä¸»é¢˜è¯†åˆ«**ï¼š95.7%
- **å†³è®®äº‹é¡¹æå–**ï¼š94.2%
- **ä»»åŠ¡ä¸­å¿ƒè¯†åˆ«**ï¼š93.8%
- **æ—¶é—´èŠ‚ç‚¹æå–**ï¼š97.1%

**ğŸ”§ æŠ€æœ¯ä¼˜åŠ¿ï¼š**
- é‡‡ç”¨æœ€æ–°çš„DeepSpeech 3.2å¼•æ“
- æ”¯æŒå®æ—¶å™ªéŸ³æŠ‘åˆ¶
- æ™ºèƒ½æ ‡ç‚¹å’Œæ–­å¥
- ä¸Šä¸‹æ–‡è¯­ä¹‰ç†è§£`;
                    } else if (question.includes('æº¯æº')) {
                        response = `**ğŸ” è¯­éŸ³æº¯æºåŠŸèƒ½è¯´æ˜**

**åŠŸèƒ½ç‰¹ç‚¹ï¼š**
- **ç²¾ç¡®å®šä½**ï¼šæ”¯æŒç§’çº§æ—¶é—´ç‚¹è·³è½¬
- **åŒå‘å…³è”**ï¼šæ–‡å­—â†”éŸ³é¢‘æ— ç¼åˆ‡æ¢
- **æ™ºèƒ½æ ‡è®°**ï¼šè‡ªåŠ¨æ ‡æ³¨é‡è¦æ®µè½
- **å¤šæ ¼å¼æ”¯æŒ**ï¼šMP3ã€WAVã€M4Aç­‰

**ä½¿ç”¨æ–¹æ³•ï¼š**
1. ç‚¹å‡»è½¬å½•æ–‡æœ¬ä¸­çš„ä»»æ„æ®µè½
2. è‡ªåŠ¨è·³è½¬åˆ°å¯¹åº”éŸ³é¢‘æ—¶é—´ç‚¹
3. æ”¯æŒæ’­æ”¾ã€æš‚åœã€å¿«è¿›å¿«é€€
4. å¯è°ƒèŠ‚æ’­æ”¾é€Ÿåº¦ï¼ˆ0.5x-2xï¼‰

**åº”ç”¨åœºæ™¯ï¼š**
- **ä¼šè®®å›é¡¾**ï¼šå¿«é€Ÿå®šä½å…³é”®è®¨è®º
- **å†…å®¹éªŒè¯**ï¼šæ ¸å®è½¬å½•æ–‡æœ¬å‡†ç¡®æ€§
- **é‡ç‚¹æ ‡è®°**ï¼šæ ‡æ³¨é‡è¦å†³è®®å†…å®¹
- **åŸ¹è®­å­¦ä¹ **ï¼šåå¤å­¦ä¹ é‡è¦ç‰‡æ®µ

**æŠ€æœ¯å®ç°ï¼š**
- åŸºäºæ—¶é—´æˆ³ç²¾ç¡®åŒæ­¥
- æ™ºèƒ½éŸ³é¢‘åˆ†æ®µæŠ€æœ¯
- æ”¯æŒéŸ³é¢‘å¯è§†åŒ–æ³¢å½¢å›¾
- å®æ—¶è¿›åº¦æ¡æ˜¾ç¤º`;
                    } else {
                        response = `æ„Ÿè°¢æ‚¨çš„å’¨è¯¢ï¼æˆ‘æ˜¯ä¸“ä¸šçš„AIä¼šè®®åŠ©æ‰‹ï¼Œå¯ä»¥ä¸ºæ‚¨æä¾›ï¼š

**ğŸ™ï¸ æ ¸å¿ƒæœåŠ¡ï¼š**
- é«˜ç²¾åº¦è¯­éŸ³è½¬æ–‡å­—ï¼ˆ98%+å‡†ç¡®ç‡ï¼‰
- æ™ºèƒ½è¯´è¯äººè¯†åˆ«ä¸åˆ†ç¦»
- è‡ªåŠ¨ç”Ÿæˆç»“æ„åŒ–ä¼šè®®çºªè¦
- æ”¯æŒéŸ³é¢‘æ–‡å­—åŒå‘æº¯æº

**ğŸ“ æ”¯æŒæ ¼å¼ï¼š**
- éŸ³é¢‘ï¼šMP3ã€WAVã€M4Aã€AAC
- æ—¶é•¿ï¼šæœ€é•¿æ”¯æŒ8å°æ—¶è¿ç»­å½•éŸ³
- è¯­è¨€ï¼šä¸­æ–‡ã€è‹±æ–‡åŠä¸»è¦æ–¹è¨€

**ğŸš€ å¤„ç†é€Ÿåº¦ï¼š**
- 1å°æ—¶å½•éŸ³çº¦éœ€3-5åˆ†é’Ÿå¤„ç†
- æ”¯æŒå®æ—¶è½¬å½•å’Œç¦»çº¿å¤„ç†
- è‡ªåŠ¨ä¿å­˜å’Œäº‘ç«¯åŒæ­¥

å¦‚éœ€äº†è§£æ›´å¤šåŠŸèƒ½ï¼Œè¯·éšæ—¶è¯¢é—®ï¼`;
                    }
                    
                    addMessage('assistant', response);
                }, 1500);
            }, 1000);
        }

        // å‘é€æ¶ˆæ¯
        function sendMessage() {
            const input = document.getElementById('message-input');
            const message = input.value.trim();
            
            if (!message || isTyping) return;
            
            addMessage('user', message);
            input.value = '';
            
            // å¦‚æœè¿˜æ²¡æœ‰ä¸Šä¼ éŸ³é¢‘ï¼Œæç¤ºç”¨æˆ·å…ˆä¸Šä¼ 
            if (!currentAudioData) {
                setTimeout(() => {
                    const response = 'è¯·å…ˆä¸Šä¼ ä¼šè®®å½•éŸ³æ–‡ä»¶ï¼Œæˆ‘å°±å¯ä»¥ä¸ºæ‚¨æä¾›è½¬å½•ã€çºªè¦ç”Ÿæˆç­‰æœåŠ¡äº†ï¼æ‚¨å¯ä»¥ç›´æ¥æ‹–æ‹½éŸ³é¢‘æ–‡ä»¶åˆ°ä¸Šæ–¹çš„ä¸Šä¼ åŒºåŸŸã€‚';
                    addMessage('assistant', response);
                }, 500);
                return;
            }
            
            // ç®€å•çš„æœç´¢åŠŸèƒ½ï¼ˆå¦‚æœå·²ä¸Šä¼ éŸ³é¢‘ï¼‰
            setTimeout(() => {
                showTypingIndicator();
                setTimeout(() => {
                    hideTypingIndicator();
                    const response = `æ­£åœ¨ä¼šè®®å†…å®¹ä¸­æœç´¢"${message}"...

ğŸ” **æœç´¢ç»“æœï¼š**
- åœ¨ **03:20** æ—¶åˆ»æ‰¾åˆ°ç›¸å…³å†…å®¹
- è¯´è¯äººï¼šç‹ç»ç†
- åŒ¹é…åº¦ï¼š95%

æ‚¨å¯ä»¥ç‚¹å‡»æ—¶é—´æˆ³è·³è½¬åˆ°å¯¹åº”çš„éŸ³é¢‘ä½ç½®ï¼Œæˆ–è¯¢é—®æˆ‘å…¶ä»–é—®é¢˜ã€‚`;
                    addMessage('assistant', response);
                }, 1500);
            }, 500);
        }

        // æ˜¾ç¤º/éšè—æ‰“å­—æŒ‡ç¤ºå™¨
        function showTypingIndicator() {
            isTyping = true;
            const container = document.getElementById('messages-container');
            const typingDiv = document.createElement('div');
            typingDiv.id = 'typing-indicator';
            typingDiv.className = 'typing-indicator mb-4';
            typingDiv.innerHTML = `
                <div class="typing-dot"></div>
                <div class="typing-dot"></div>
                <div class="typing-dot"></div>
                <span class="ml-2 text-sm text-gray-500">ä¼šè®®åŠ©æ‰‹æ­£åœ¨å¤„ç†éŸ³é¢‘...</span>
            `;
            container.appendChild(typingDiv);
            container.scrollTop = container.scrollHeight;
        }

        function hideTypingIndicator() {
            isTyping = false;
            const indicator = document.getElementById('typing-indicator');
            if (indicator) {
                indicator.remove();
            }
        }

        // éŸ³é¢‘æ§åˆ¶åŠŸèƒ½
        function toggleAudio() {
            showToast('éŸ³é¢‘æ’­æ”¾åŠŸèƒ½å·²é›†æˆï¼Œæ”¯æŒæ’­æ”¾æ§åˆ¶å’Œè¿›åº¦è°ƒèŠ‚', 'info');
        }

        function seekAudio(event) {
            showToast('æ”¯æŒç‚¹å‡»è¿›åº¦æ¡è·³è½¬åˆ°æŒ‡å®šæ—¶é—´ç‚¹', 'info');
        }

        function jumpToAudio(time) {
            showToast(`æ­£åœ¨è·³è½¬åˆ° ${time} æ—¶é—´ç‚¹`, 'info');
            
            // æ˜¾ç¤ºéŸ³é¢‘æ¥æºè¯¦æƒ…
            const sourceData = {
                filename: meetingData.audioFile,
                timestamp: time,
                accuracy: "97%",
                transcript: meetingData.transcript.find(t => t.time === time)?.text || "éŸ³é¢‘ç‰‡æ®µå†…å®¹",
                speakers: meetingData.participants
            };
            
            // å¡«å……å¼¹çª—æ•°æ®
            document.getElementById('audio-filename').textContent = sourceData.filename;
            document.getElementById('audio-timestamp').textContent = sourceData.timestamp;
            document.getElementById('audio-accuracy').textContent = sourceData.accuracy;
            document.getElementById('transcript-content').textContent = sourceData.transcript;
            
            // ç”Ÿæˆè¯´è¯äººæ ‡ç­¾
            const speakerContainer = document.getElementById('speaker-info');
            speakerContainer.innerHTML = '';
            sourceData.speakers.forEach(speaker => {
                const tag = document.createElement('span');
                tag.className = 'speaker-tag';
                tag.textContent = speaker;
                speakerContainer.appendChild(tag);
            });
            
            document.getElementById('source-modal').classList.add('show');
        }

        // æ˜¾ç¤ºæ¥æºè¯¦æƒ…
        function showSourceDetail(messageId) {
            const messageElement = document.getElementById(messageId);
            const audioDataStr = messageElement.getAttribute('data-audio');
            
            if (audioDataStr) {
                const audioData = JSON.parse(audioDataStr);
                
                document.getElementById('audio-filename').textContent = audioData.filename;
                document.getElementById('audio-timestamp').textContent = "å®Œæ•´ä¼šè®®";
                document.getElementById('audio-accuracy').textContent = "97.3%";
                document.getElementById('transcript-content').textContent = audioData.transcript[0].text;
                
                const speakerContainer = document.getElementById('speaker-info');
                speakerContainer.innerHTML = '';
                audioData.participants.forEach(speaker => {
                    const tag = document.createElement('span');
                    tag.className = 'speaker-tag';
                    tag.textContent = speaker;
                    speakerContainer.appendChild(tag);
                });
                
                document.getElementById('source-modal').classList.add('show');
            }
        }

        function closeSourceModal() {
            document.getElementById('source-modal').classList.remove('show');
        }

        // äº¤äº’æŒ‰é’®åŠŸèƒ½ï¼ˆå¤ç”¨åˆ¶åº¦åŠ©æ‰‹çš„é€»è¾‘ï¼‰
        function likeMessage(messageId) {
            const btn = document.querySelector(`#${messageId} .action-btn.like`);
            const dislikeBtn = document.querySelector(`#${messageId} .action-btn.dislike`);
            
            btn.classList.toggle('active');
            dislikeBtn.classList.remove('active');
            
            if (btn.classList.contains('active')) {
                showToast('æ„Ÿè°¢æ‚¨çš„åé¦ˆï¼è¿™å°†å¸®åŠ©æˆ‘ä»¬æ”¹è¿›è¯­éŸ³è¯†åˆ«è´¨é‡', 'success');
            } else {
                showToast('å·²å–æ¶ˆç‚¹èµ', 'info');
            }
        }

        function dislikeMessage(messageId) {
            const btn = document.querySelector(`#${messageId} .action-btn.dislike`);
            const likeBtn = document.querySelector(`#${messageId} .action-btn.like`);
            
            btn.classList.toggle('active');
            likeBtn.classList.remove('active');
            
            if (btn.classList.contains('active')) {
                showToast('æˆ‘ä»¬å·²è®°å½•æ‚¨çš„åé¦ˆï¼Œä¼šæŒç»­ä¼˜åŒ–è½¬å½•å‡†ç¡®æ€§', 'info');
            }
        }

        function editAnswer(messageId) {
            showToast('ç¼–è¾‘åŠŸèƒ½å·²å¯ç”¨ï¼Œæ‚¨å¯ä»¥ä¿®æ­£è½¬å½•æ–‡æœ¬æˆ–çºªè¦å†…å®¹', 'info');
        }

        function getAssistance(messageId) {
            showToast('è¾…åŠ©åŠŸèƒ½å·²å¯ç”¨ï¼Œå¯ä»¥è¯·æ±‚éŸ³é¢‘å¤„ç†ã€æ ¼å¼è½¬æ¢ç­‰å¸®åŠ©', 'info');
        }

        // æ¸…ç©ºèŠå¤©
        function clearChat() {
            document.getElementById('messages-container').innerHTML = `
                <!-- åŠ©æ‰‹ä»‹ç»æ¶ˆæ¯ -->
                <div class="message-bubble assistant-message p-4 mb-4">
                    <div class="prose prose-sm max-w-none text-gray-700 mb-4">
                        <p class="mb-3">æˆ‘èƒ½å¤Ÿå°†æ‚¨çš„ä¼šè®®å½•éŸ³è½¬ä¸ºæ–‡å­—è®°å½•ï¼Œè‡ªåŠ¨ç”Ÿæˆä¼šè®®çºªè¦ï¼Œè®©æ‚¨ä¸“æ³¨äºä¼šè®®å†…å®¹ï¼Œå‘Šåˆ«æ‰‹å·¥è®°å½•çš„çƒ¦æ¼ã€‚</p>
                        <p class="mb-3">æˆ‘æ”¯æŒ<span class="font-semibold text-green-600">è¯­éŸ³è¯†åˆ«è½¬å†™</span>ã€<span class="font-semibold text-green-600">è¯´è¯äººè¯†åˆ«</span>å’Œ<span class="font-semibold text-green-600">æ™ºèƒ½çºªè¦ç”Ÿæˆ</span>ã€‚</p>
                        <p class="text-sm text-gray-600">ğŸ¯ <strong>æ ¸å¿ƒåŠŸèƒ½ï¼š</strong>è¯­éŸ³è½¬æ–‡å­—ï¼ˆä¸å¼ºç­”æœºåˆ¶ï¼‰ã€è‡ªåŠ¨åˆ†è§’è‰²ã€ä¼šè®®çºªè¦ç”Ÿæˆã€å…³é”®ä¿¡æ¯æå–</p>
                    </div>
                    <p class="text-gray-700 font-medium">è¯·å…ˆä¸Šä¼ æ‚¨çš„ä¼šè®®å½•éŸ³æ–‡ä»¶ï¼š</p>
                </div>
                
                <!-- éŸ³é¢‘ä¸Šä¼ åŒºåŸŸ -->
                <div id="upload-section" class="mb-6">
                    <div class="upload-area" id="upload-area" onclick="triggerFileUpload()">
                        <div class="text-center py-8">
                            <div class="w-16 h-16 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-4">
                                <svg class="w-8 h-8 text-green-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"></path>
                                </svg>
                            </div>
                            <h3 class="text-lg font-semibold text-gray-800 mb-2">ä¸Šä¼ ä¼šè®®å½•éŸ³æ–‡ä»¶</h3>
                            <p class="text-gray-600 mb-4">æ”¯æŒ MP3ã€WAVã€M4A æ ¼å¼ï¼Œæœ€å¤§æ”¯æŒ 200MB</p>
                            <div class="flex items-center justify-center space-x-4 text-sm text-gray-500">
                                <span class="flex items-center">
                                    <svg class="w-4 h-4 mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"></path>
                                    </svg>
                                    å®‰å…¨åŠ å¯†
                                </span>
                                <span class="flex items-center">
                                    <svg class="w-4 h-4 mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z"></path>
                                    </svg>
                                    å¿«é€Ÿå¤„ç†
                                </span>
                                <span class="flex items-center">
                                    <svg class="w-4 h-4 mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                                    </svg>
                                    98%å‡†ç¡®ç‡
                                </span>
                            </div>
                            <button class="mt-4 bg-green-500 text-white px-6 py-2 rounded-lg hover:bg-green-600 transition-colors">
                                é€‰æ‹©æ–‡ä»¶
                            </button>
                            <p class="text-xs text-gray-400 mt-2">æˆ–ç›´æ¥æ‹–æ‹½æ–‡ä»¶åˆ°æ­¤åŒºåŸŸ</p>
                        </div>
                    </div>
                    <input type="file" id="audio-file-input" accept="audio/*" style="display: none;" onchange="handleFileUpload(event)">
                </div>
                
                <!-- ç¤ºä¾‹æ–‡ä»¶ -->
                <div id="sample-section" class="mb-6">
                    <p class="text-sm font-medium text-gray-700 mb-3">ğŸ“ æˆ–è€…è¯•è¯•æˆ‘ä»¬çš„ç¤ºä¾‹æ–‡ä»¶ï¼š</p>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-3">
                        <div class="feature-card specular-highlight" onclick="loadSampleAudio('è‘£äº‹ä¼šä¾‹ä¼š')">
                            <div class="flex items-center">
                                <div class="w-8 h-8 bg-blue-100 rounded-lg flex items-center justify-center mr-3">
                                    <span class="text-blue-600 text-sm">ğŸ¢</span>
                                </div>
                                <div>
                                    <h4 class="font-medium text-gray-800">è‘£äº‹ä¼šä¾‹ä¼š</h4>
                                    <p class="text-xs text-gray-600">4äººå‚ä¼š â€¢ 45åˆ†é’Ÿ</p>
                                </div>
                            </div>
                        </div>
                        
                        <div class="feature-card specular-highlight" onclick="loadSampleAudio('é¡¹ç›®è¯„å®¡ä¼š')">
                            <div class="flex items-center">
                                <div class="w-8 h-8 bg-purple-100 rounded-lg flex items-center justify-center mr-3">
                                    <span class="text-purple-600 text-sm">ğŸ’¼</span>
                                </div>
                                <div>
                                    <h4 class="font-medium text-gray-800">é¡¹ç›®è¯„å®¡ä¼š</h4>
                                    <p class="text-xs text-gray-600">6äººå‚ä¼š â€¢ 62åˆ†é’Ÿ</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            `;
            conversationHistory = [];
            currentContext = [];
            currentAudioData = null;
            
            // é‡æ–°ç»‘å®šæ‹–æ‹½äº‹ä»¶
            setupDragAndDrop();
        }

        // è®¾ç½®æ‹–æ‹½ä¸Šä¼ åŠŸèƒ½
        function setupDragAndDrop() {
            const uploadArea = document.getElementById('upload-area');
            if (!uploadArea) return;

            ['dragenter', 'dragover', 'dragleave', 'drop'].forEach(eventName => {
                uploadArea.addEventListener(eventName, preventDefaults, false);
            });

            function preventDefaults(e) {
                e.preventDefault();
                e.stopPropagation();
            }

            ['dragenter', 'dragover'].forEach(eventName => {
                uploadArea.addEventListener(eventName, highlight, false);
            });

            ['dragleave', 'drop'].forEach(eventName => {
                uploadArea.addEventListener(eventName, unhighlight, false);
            });

            function highlight(e) {
                uploadArea.classList.add('dragover');
            }

            function unhighlight(e) {
                uploadArea.classList.remove('dragover');
            }

            uploadArea.addEventListener('drop', handleDrop, false);

            function handleDrop(e) {
                const dt = e.dataTransfer;
                const files = dt.files;

                if (files.length > 0) {
                    const file = files[0];
                    if (file.type.startsWith('audio/')) {
                        processAudioFile(file);
                    } else {
                        showToast('è¯·ä¸Šä¼ éŸ³é¢‘æ–‡ä»¶ï¼ˆMP3ã€WAVã€M4Aæ ¼å¼ï¼‰', 'error');
                    }
                }
            }
        }

        // åˆå§‹åŒ–
        document.addEventListener('DOMContentLoaded', function() {
            console.log('ä¼šè®®åŠ©æ‰‹èŠå¤©ç•Œé¢å·²åŠ è½½å®Œæˆ');
            
            // è®¾ç½®æ‹–æ‹½ä¸Šä¼ 
            setupDragAndDrop();
            
            document.getElementById('source-modal').addEventListener('click', function(e) {
                if (e.target === this) {
                    closeSourceModal();
                }
            });
        });
    </script>
</body>
</html>