<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ™ºèƒ½æ–‡æ¡£å·¥å‚ï¼ˆADFï¼‰ - æ¶æ„ç®¡æ§å¹³å°</title>
    <script src="/console/style/tailwindcss.3.0.23.js"></script>
    <style>
        body {
            /* background: linear-gradient(135deg, #f0f2f5 0%, #e8ecf0 50%, #f5f7fa 100%); */
            min-height: 100vh;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
        }
        
        .liquid-glass {
            background: rgba(255, 255, 255, 0.85);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.3);
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
        }
        
        .liquid-glass-strong {
            /* background: rgba(255, 255, 255, 0.95); */
            backdrop-filter: blur(25px);
            border: 1px solid rgba(255, 255, 255, 0.4);
            box-shadow: 0 12px 40px rgba(0, 0, 0, 0.12);
        }
        
        .specular-highlight {
            position: relative;
            overflow: hidden;
        }
        
        .specular-highlight::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.4), transparent);
            transition: left 0.6s ease;
            pointer-events: none;
        }
        
        .specular-highlight:hover::before {
            left: 100%;
        }
        
        .doc-type-card {
            background: rgba(255, 255, 255, 0.9);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.3);
            border-radius: 16px;
            padding: 20px;
            transition: all 0.3s cubic-bezier(0.25, 0.46, 0.45, 0.94);
            cursor: pointer;
        }
        
        .doc-type-card:hover {
            transform: translateY(-4px);
            box-shadow: 0 16px 48px rgba(0, 0, 0, 0.1);
            border-color: rgba(59, 130, 246, 0.3);
            background: rgba(255, 255, 255, 0.95);
        }
        
        .doc-type-card.active {
            border-color: rgba(59, 130, 246, 0.5);
            background: linear-gradient(135deg, rgba(59, 130, 246, 0.05) 0%, rgba(255, 255, 255, 0.95) 100%);
        }
        
        .floating-button {
            transform: translateY(0);
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }
        
        .floating-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 12px 40px rgba(0, 0, 0, 0.15);
        }
        
        .progress-step {
            position: relative;
            display: flex;
            align-items: center;
            justify-content: center;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.9);
            border: 2px solid rgba(203, 213, 225, 0.5);
            font-weight: 600;
            color: #94a3b8;
            transition: all 0.3s ease;
        }
        
        .progress-step.active {
            background: linear-gradient(135deg, #3b82f6 0%, #2563eb 100%);
            border-color: #3b82f6;
            color: white;
            box-shadow: 0 4px 20px rgba(59, 130, 246, 0.3);
        }
        
        .progress-step.completed {
            background: linear-gradient(135deg, #10b981 0%, #059669 100%);
            border-color: #10b981;
            color: white;
        }
        
        .template-preview {
            background: rgba(255, 255, 255, 0.95);
            border: 1px solid rgba(0, 0, 0, 0.1);
            border-radius: 12px;
            padding: 16px;
            margin-top: 12px;
            max-height: 300px;
            overflow-y: auto;
        }
        
        .ai-suggestion {
            background: linear-gradient(135deg, rgba(147, 51, 234, 0.05) 0%, rgba(255, 255, 255, 0.95) 100%);
            border: 1px solid rgba(147, 51, 234, 0.2);
            border-radius: 12px;
            padding: 12px;
            margin: 8px 0;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .ai-suggestion:hover {
            transform: translateX(4px);
            box-shadow: 0 4px 16px rgba(147, 51, 234, 0.1);
        }
        
        .toast {
            position: fixed;
            top: 20px;
            right: 20px;
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.3);
            border-radius: 12px;
            padding: 16px 20px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
            transform: translateX(400px);
            transition: transform 0.3s ease;
            z-index: 1001;
            min-width: 300px;
        }
        
        .toast.show {
            transform: translateX(0);
        }
        
        .toast.success {
            border-left: 4px solid #10b981;
        }
        
        .toast.error {
            border-left: 4px solid #ef4444;
        }
        
        .toast.info {
            border-left: 4px solid #3b82f6;
        }
        
        .generating-animation {
            display: inline-block;
            animation: pulse 2s cubic-bezier(0.4, 0, 0.6, 1) infinite;
        }
        
        @keyframes pulse {
            0%, 100% {
                opacity: 1;
            }
            50% {
                opacity: 0.5;
            }
        }
        
        .editor-toolbar {
            background: rgba(255, 255, 255, 0.9);
            border: 1px solid rgba(0, 0, 0, 0.1);
            border-radius: 8px;
            padding: 8px;
            display: flex;
            gap: 8px;
            margin-bottom: 12px;
        }
        
        .toolbar-btn {
            padding: 6px 12px;
            border-radius: 6px;
            background: rgba(255, 255, 255, 0.8);
            border: 1px solid rgba(0, 0, 0, 0.1);
            cursor: pointer;
            transition: all 0.2s ease;
            font-size: 14px;
        }
        
        .toolbar-btn:hover {
            background: rgba(59, 130, 246, 0.1);
            border-color: rgba(59, 130, 246, 0.3);
        }
        
        .chapter-item {
            background: rgba(255, 255, 255, 0.9);
            border: 1px solid rgba(0, 0, 0, 0.1);
            border-radius: 8px;
            padding: 12px;
            margin: 8px 0;
            cursor: move;
            transition: all 0.3s ease;
        }
        
        .chapter-item:hover {
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        }
        
        .chapter-item.dragging {
            opacity: 0.5;
        }
    </style>
</head>
<body class="h-screen flex">
    <!-- ä¾§è¾¹æ  -->
    <div class="w-80 liquid-glass-strong p-6 overflow-y-auto">
        <div class="mb-6">
            <img src="/console/img/agreeLogo.png" alt="Logo" class="h-10 mb-4">
            <h1 class="text-2xl font-bold text-gray-800 mb-2">æ™ºèƒ½æ–‡æ¡£å·¥å‚</h1>
            <p class="text-sm text-gray-600">AIé©±åŠ¨çš„æ¶æ„æ–‡æ¡£è‡ªåŠ¨ç”Ÿæˆå¹³å°</p>
        </div>
        
        <!-- è¿›åº¦æŒ‡ç¤ºå™¨ -->
        <div class="mb-8">
            <div class="flex items-center justify-between mb-4">
                <div class="progress-step completed" id="step1">1</div>
                <div class="flex-1 h-0.5 bg-gray-300 mx-2"></div>
                <div class="progress-step active" id="step2">2</div>
                <div class="flex-1 h-0.5 bg-gray-300 mx-2"></div>
                <div class="progress-step" id="step3">3</div>
                <div class="flex-1 h-0.5 bg-gray-300 mx-2"></div>
                <div class="progress-step" id="step4">4</div>
            </div>
            <div class="flex justify-between text-xs text-gray-600">
                <span>é€‰æ‹©ç±»å‹</span>
                <span>é…ç½®æ¨¡æ¿</span>
                <span>ç”Ÿæˆæ–‡æ¡£</span>
                <span>å¯¼å‡º</span>
            </div>
        </div>
        
        <!-- æ–‡æ¡£ç±»å‹é€‰æ‹© -->
        <div class="mb-6">
            <h3 class="text-lg font-semibold text-gray-800 mb-3">ğŸ“„ æ–‡æ¡£ç±»å‹</h3>
            <div class="space-y-3">
                <div class="doc-type-card specular-highlight active" onclick="selectDocType('design-report')">
                    <div class="flex items-start">
                        <div class="w-10 h-10 bg-blue-100 rounded-lg flex items-center justify-center mr-3">
                            <span class="text-blue-600">ğŸ“‹</span>
                        </div>
                        <div class="flex-1">
                            <h4 class="font-semibold text-gray-800">æ¶æ„è®¾è®¡æŠ¥å‘Š</h4>
                            <p class="text-xs text-gray-600 mt-1">ç³»ç»Ÿæ¶æ„è®¾è®¡æ–‡æ¡£ã€æŠ€æœ¯æ–¹æ¡ˆ</p>
                        </div>
                    </div>
                </div>
                
                <div class="doc-type-card specular-highlight" onclick="selectDocType('assessment')">
                    <div class="flex items-start">
                        <div class="w-10 h-10 bg-green-100 rounded-lg flex items-center justify-center mr-3">
                            <span class="text-green-600">ğŸ“Š</span>
                        </div>
                        <div class="flex-1">
                            <h4 class="font-semibold text-gray-800">æ¶æ„è¯„ä¼°æŠ¥å‘Š</h4>
                            <p class="text-xs text-gray-600 mt-1">æ¶æ„å¥åº·åº¦ã€åˆè§„æ€§è¯„ä¼°</p>
                        </div>
                    </div>
                </div>
                
                <div class="doc-type-card specular-highlight" onclick="selectDocType('change-analysis')">
                    <div class="flex items-start">
                        <div class="w-10 h-10 bg-purple-100 rounded-lg flex items-center justify-center mr-3">
                            <span class="text-purple-600">ğŸ”„</span>
                        </div>
                        <div class="flex-1">
                            <h4 class="font-semibold text-gray-800">å˜æ›´å½±å“åˆ†æ</h4>
                            <p class="text-xs text-gray-600 mt-1">ç³»ç»Ÿå˜æ›´çš„å½±å“è¯„ä¼°åˆ†æ</p>
                        </div>
                    </div>
                </div>
                
                <div class="doc-type-card specular-highlight" onclick="selectDocType('meeting-minutes')">
                    <div class="flex items-start">
                        <div class="w-10 h-10 bg-cyan-100 rounded-lg flex items-center justify-center mr-3">
                            <span class="text-cyan-600">ğŸ“</span>
                        </div>
                        <div class="flex-1">
                            <h4 class="font-semibold text-gray-800">ä¼šè®®çºªè¦</h4>
                            <p class="text-xs text-gray-600 mt-1">æ¶æ„è¯„å®¡ä¼šã€å†³ç­–ä¼šè®®çºªè¦</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- AIå»ºè®® -->
        <div class="mb-6">
            <h3 class="text-lg font-semibold text-gray-800 mb-3">ğŸ¤– AIå»ºè®®</h3>
            <div id="ai-suggestions">
                <div class="ai-suggestion" onclick="applyAISuggestion('template1')">
                    <div class="flex items-center justify-between">
                        <span class="text-sm font-medium text-purple-700">æ¨èæ¨¡æ¿ï¼šå¾®æœåŠ¡æ¶æ„è®¾è®¡</span>
                        <span class="text-xs text-purple-500">95%åŒ¹é…</span>
                    </div>
                    <p class="text-xs text-gray-600 mt-1">åŸºäºæ‚¨çš„ç³»ç»Ÿç‰¹å¾ï¼Œæ¨èä½¿ç”¨æ­¤æ¨¡æ¿</p>
                </div>
                <div class="ai-suggestion" onclick="applyAISuggestion('content1')">
                    <div class="flex items-center justify-between">
                        <span class="text-sm font-medium text-purple-700">è¡¥å……å»ºè®®ï¼šæ·»åŠ æ€§èƒ½æŒ‡æ ‡</span>
                        <span class="text-xs text-purple-500">å»ºè®®</span>
                    </div>
                    <p class="text-xs text-gray-600 mt-1">å»ºè®®åœ¨æ–‡æ¡£ä¸­åŠ å…¥æ€§èƒ½åŸºçº¿è¯´æ˜</p>
                </div>
            </div>
        </div>
    </div>
    
    <!-- ä¸»å·¥ä½œåŒº -->
    <div class="flex-1 flex flex-col">
        <!-- é¡¶éƒ¨å·¥å…·æ  -->
        <div class="liquid-glass p-4 flex items-center justify-between">
            <div class="flex items-center space-x-4">
                <h2 class="text-xl font-semibold text-gray-800">æ¶æ„è®¾è®¡æŠ¥å‘Š</h2>
                <span class="px-3 py-1 bg-blue-100 text-blue-700 text-sm rounded-full">è‰ç¨¿</span>
            </div>
            <div class="flex items-center space-x-3">
                <button onclick="previewDocument()" class="liquid-glass floating-button rounded-lg px-4 py-2 text-sm font-medium text-gray-700 specular-highlight">
                    <span class="mr-2">ğŸ‘ï¸</span>é¢„è§ˆ
                </button>
                <button onclick="saveDocument()" class="liquid-glass floating-button rounded-lg px-4 py-2 text-sm font-medium text-gray-700 specular-highlight">
                    <span class="mr-2">ğŸ’¾</span>ä¿å­˜
                </button>
                <button onclick="generateDocument()" class="bg-blue-500 text-white rounded-lg px-4 py-2 text-sm font-medium hover:bg-blue-600 transition-colors">
                    <span class="mr-2">âœ¨</span>AIç”Ÿæˆ
                </button>
            </div>
        </div>
        
        <!-- ä¸»ç¼–è¾‘åŒº -->
        <div class="flex-1 flex">
            <!-- å·¦ä¾§ï¼šç« èŠ‚ç»“æ„ -->
            <div class="w-64 liquid-glass p-4 overflow-y-auto">
                <h3 class="text-lg font-semibold text-gray-800 mb-4">ğŸ“š æ–‡æ¡£ç»“æ„</h3>
                <div id="chapter-list">
                    <div class="chapter-item" draggable="true">
                        <div class="flex items-center justify-between">
                            <span class="text-sm font-medium">1. æ¦‚è¿°</span>
                            <button onclick="editChapter(1)" class="text-gray-500 hover:text-gray-700">
                                âœï¸
                            </button>
                        </div>
                    </div>
                    <div class="chapter-item" draggable="true">
                        <div class="flex items-center justify-between">
                            <span class="text-sm font-medium">2. ä¸šåŠ¡æ¶æ„</span>
                            <button onclick="editChapter(2)" class="text-gray-500 hover:text-gray-700">
                                âœï¸
                            </button>
                        </div>
                    </div>
                    <div class="chapter-item" draggable="true">
                        <div class="flex items-center justify-between">
                            <span class="text-sm font-medium">3. åº”ç”¨æ¶æ„</span>
                            <button onclick="editChapter(3)" class="text-gray-500 hover:text-gray-700">
                                âœï¸
                            </button>
                        </div>
                    </div>
                    <div class="chapter-item" draggable="true">
                        <div class="flex items-center justify-between">
                            <span class="text-sm font-medium">4. æ•°æ®æ¶æ„</span>
                            <button onclick="editChapter(4)" class="text-gray-500 hover:text-gray-700">
                                âœï¸
                            </button>
                        </div>
                    </div>
                    <div class="chapter-item" draggable="true">
                        <div class="flex items-center justify-between">
                            <span class="text-sm font-medium">5. æŠ€æœ¯æ¶æ„</span>
                            <button onclick="editChapter(5)" class="text-gray-500 hover:text-gray-700">
                                âœï¸
                            </button>
                        </div>
                    </div>
                </div>
                <button onclick="addChapter()" class="mt-4 w-full liquid-glass floating-button rounded-lg px-4 py-2 text-sm font-medium text-gray-700 specular-highlight">
                    <span class="mr-2">â•</span>æ·»åŠ ç« èŠ‚
                </button>
            </div>
            
            <!-- å³ä¾§ï¼šå†…å®¹ç¼–è¾‘ -->
            <div class="flex-1 p-6 overflow-y-auto">
                <div class="liquid-glass-strong rounded-lg p-6">
                    <!-- ç¼–è¾‘å·¥å…·æ  -->
                    <div class="editor-toolbar">
                        <button class="toolbar-btn" onclick="formatText('bold')">
                            <strong>B</strong>
                        </button>
                        <button class="toolbar-btn" onclick="formatText('italic')">
                            <em>I</em>
                        </button>
                        <button class="toolbar-btn" onclick="formatText('heading')">
                            H
                        </button>
                        <button class="toolbar-btn" onclick="formatText('list')">
                            â‰¡
                        </button>
                        <button class="toolbar-btn" onclick="insertTemplate()">
                            ğŸ“‹ æ’å…¥æ¨¡æ¿
                        </button>
                        <button class="toolbar-btn" onclick="aiAssist()">
                            ğŸ¤– AIè¾…åŠ©
                        </button>
                    </div>
                    
                    <!-- å†…å®¹ç¼–è¾‘åŒº -->
                    <div id="editor-content" contenteditable="true" class="min-h-96 p-4 border border-gray-200 rounded-lg bg-white focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                        <h1 class="text-2xl font-bold text-gray-800 mb-4">1. æ¦‚è¿°</h1>
                        <p class="text-gray-700 mb-3">æœ¬æ–‡æ¡£æè¿°äº†<span class="text-blue-600">[ç³»ç»Ÿåç§°]</span>çš„æ•´ä½“æ¶æ„è®¾è®¡æ–¹æ¡ˆï¼ŒåŒ…æ‹¬ä¸šåŠ¡æ¶æ„ã€åº”ç”¨æ¶æ„ã€æ•°æ®æ¶æ„å’ŒæŠ€æœ¯æ¶æ„ç­‰æ–¹é¢çš„è¯¦ç»†è¯´æ˜ã€‚</p>
                        
                        <h2 class="text-xl font-semibold text-gray-800 mt-6 mb-3">1.1 æ–‡æ¡£ç›®çš„</h2>
                        <p class="text-gray-700 mb-3">æ˜ç¡®ç³»ç»Ÿçš„æ¶æ„è®¾è®¡åŸåˆ™ã€æ¶æ„å†³ç­–å’Œå®æ–½æ–¹æ¡ˆï¼Œä¸ºç³»ç»Ÿçš„å¼€å‘ã€éƒ¨ç½²å’Œè¿ç»´æä¾›æŒ‡å¯¼ã€‚</p>
                        
                        <h2 class="text-xl font-semibold text-gray-800 mt-6 mb-3">1.2 æ–‡æ¡£èŒƒå›´</h2>
                        <ul class="list-disc list-inside text-gray-700 space-y-1">
                            <li>ç³»ç»Ÿæ€»ä½“æ¶æ„è®¾è®¡</li>
                            <li>æ ¸å¿ƒä¸šåŠ¡æµç¨‹è®¾è®¡</li>
                            <li>å…³é”®æŠ€æœ¯é€‰å‹</li>
                            <li>éƒ¨ç½²æ¶æ„æ–¹æ¡ˆ</li>
                        </ul>
                        
                        <div class="mt-6 p-4 bg-blue-50 border-l-4 border-blue-500 rounded">
                            <p class="text-sm text-blue-700">
                                <strong>AIæç¤ºï¼š</strong>ç‚¹å‡»å·¥å…·æ çš„"AIè¾…åŠ©"æŒ‰é’®ï¼Œæˆ‘å¯ä»¥å¸®æ‚¨è‡ªåŠ¨ç”Ÿæˆæˆ–ä¼˜åŒ–æ–‡æ¡£å†…å®¹ã€‚
                            </p>
                        </div>
                    </div>
                    
                    <!-- AIç”ŸæˆçŠ¶æ€ -->
                    <div id="generating-status" class="hidden mt-4 p-4 bg-purple-50 rounded-lg">
                        <div class="flex items-center">
                            <span class="generating-animation mr-3">ğŸ¤–</span>
                            <span class="text-purple-700">AIæ­£åœ¨ç”Ÿæˆæ–‡æ¡£å†…å®¹...</span>
                        </div>
                        <div class="mt-2 w-full bg-purple-200 rounded-full h-2">
                            <div id="progress-bar" class="bg-purple-600 h-2 rounded-full transition-all duration-500" style="width: 0%"></div>
                        </div>
                    </div>
                </div>
                
                <!-- ç‰ˆæœ¬å†å² -->
                <div class="mt-6 liquid-glass-strong rounded-lg p-6">
                    <h3 class="text-lg font-semibold text-gray-800 mb-4">ğŸ“œ ç‰ˆæœ¬å†å²</h3>
                    <div class="space-y-2">
                        <div class="flex items-center justify-between p-3 bg-gray-50 rounded-lg">
                            <div>
                                <span class="text-sm font-medium text-gray-700">v1.0 - åˆå§‹ç‰ˆæœ¬</span>
                                <span class="text-xs text-gray-500 ml-2">2024-01-15 14:30</span>
                            </div>
                            <button onclick="viewVersion('v1.0')" class="text-blue-600 text-sm hover:underline">æŸ¥çœ‹</button>
                        </div>
                        <div class="flex items-center justify-between p-3 bg-gray-50 rounded-lg">
                            <div>
                                <span class="text-sm font-medium text-gray-700">v1.1 - æ›´æ–°ä¸šåŠ¡æ¶æ„</span>
                                <span class="text-xs text-gray-500 ml-2">2024-01-16 10:15</span>
                            </div>
                            <button onclick="viewVersion('v1.1')" class="text-blue-600 text-sm hover:underline">æŸ¥çœ‹</button>
                        </div>
                        <div class="flex items-center justify-between p-3 bg-blue-50 rounded-lg border border-blue-200">
                            <div>
                                <span class="text-sm font-medium text-blue-700">v1.2 - å½“å‰ç‰ˆæœ¬</span>
                                <span class="text-xs text-blue-500 ml-2">2024-01-16 15:45</span>
                            </div>
                            <span class="text-blue-600 text-sm">å½“å‰</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        let currentDocType = 'design-report';
        let documentContent = {};
        let isGenerating = false;

        // æ–‡æ¡£ç±»å‹æ¨¡æ¿
        const docTemplates = {
            'design-report': {
                title: 'æ¶æ„è®¾è®¡æŠ¥å‘Š',
                chapters: [
                    '1. æ¦‚è¿°',
                    '2. ä¸šåŠ¡æ¶æ„',
                    '3. åº”ç”¨æ¶æ„',
                    '4. æ•°æ®æ¶æ„',
                    '5. æŠ€æœ¯æ¶æ„',
                    '6. éƒ¨ç½²æ¶æ„',
                    '7. å®‰å…¨æ¶æ„',
                    '8. æ¶æ„å†³ç­–è®°å½•'
                ]
            },
            'assessment': {
                title: 'æ¶æ„è¯„ä¼°æŠ¥å‘Š',
                chapters: [
                    '1. è¯„ä¼°æ¦‚è¿°',
                    '2. æ¶æ„ç°çŠ¶åˆ†æ',
                    '3. åˆè§„æ€§è¯„ä¼°',
                    '4. æ€§èƒ½è¯„ä¼°',
                    '5. å®‰å…¨è¯„ä¼°',
                    '6. æŠ€æœ¯å€ºåŠ¡åˆ†æ',
                    '7. æ”¹è¿›å»ºè®®',
                    '8. å®æ–½è·¯çº¿å›¾'
                ]
            },
            'change-analysis': {
                title: 'å˜æ›´å½±å“åˆ†æ',
                chapters: [
                    '1. å˜æ›´æ¦‚è¿°',
                    '2. å˜æ›´å†…å®¹',
                    '3. å½±å“èŒƒå›´åˆ†æ',
                    '4. é£é™©è¯„ä¼°',
                    '5. ä¾èµ–åˆ†æ',
                    '6. å®æ–½è®¡åˆ’',
                    '7. å›æ»šæ–¹æ¡ˆ'
                ]
            },
            'meeting-minutes': {
                title: 'ä¼šè®®çºªè¦',
                chapters: [
                    '1. ä¼šè®®ä¿¡æ¯',
                    '2. å‚ä¼šäººå‘˜',
                    '3. è®®é¢˜è®¨è®º',
                    '4. å†³è®®äº‹é¡¹',
                    '5. è¡ŒåŠ¨è®¡åˆ’',
                    '6. åç»­å·¥ä½œ'
                ]
            }
        };

        // Toastæç¤º
        function showToast(message, type = 'info') {
            const toast = document.createElement('div');
            toast.className = `toast ${type}`;
            toast.innerHTML = `
                <div class="flex items-center">
                    <div class="mr-3">
                        ${type === 'success' ? 'âœ…' : type === 'error' ? 'âŒ' : 'â„¹ï¸'}
                    </div>
                    <div class="font-medium text-gray-800">${message}</div>
                </div>
            `;
            document.body.appendChild(toast);
            setTimeout(() => toast.classList.add('show'), 100);
            setTimeout(() => {
                toast.classList.remove('show');
                setTimeout(() => toast.remove(), 300);
            }, 3000);
        }

        // é€‰æ‹©æ–‡æ¡£ç±»å‹
        function selectDocType(type) {
            currentDocType = type;
            
            // æ›´æ–°é€‰ä¸­çŠ¶æ€
            document.querySelectorAll('.doc-type-card').forEach(card => {
                card.classList.remove('active');
            });
            event.currentTarget.classList.add('active');
            
            // æ›´æ–°ç« èŠ‚åˆ—è¡¨
            updateChapterList(type);
            
            // æ›´æ–°æ ‡é¢˜
            const template = docTemplates[type];
            document.querySelector('h2').textContent = template.title;
            
            // æ›´æ–°è¿›åº¦
            updateProgress(2);
            
            showToast(`å·²é€‰æ‹©ï¼š${template.title}`, 'success');
        }

        // æ›´æ–°ç« èŠ‚åˆ—è¡¨
        function updateChapterList(type) {
            const template = docTemplates[type];
            const chapterList = document.getElementById('chapter-list');
            
            chapterList.innerHTML = template.chapters.map((chapter, index) => `
                <div class="chapter-item" draggable="true">
                    <div class="flex items-center justify-between">
                        <span class="text-sm font-medium">${chapter}</span>
                        <button onclick="editChapter(${index + 1})" class="text-gray-500 hover:text-gray-700">
                            âœï¸
                        </button>
                    </div>
                </div>
            `).join('');
            
            initDragAndDrop();
        }

        // æ›´æ–°è¿›åº¦æ¡
        function updateProgress(step) {
            for (let i = 1; i <= 4; i++) {
                const stepEl = document.getElementById(`step${i}`);
                if (i < step) {
                    stepEl.classList.add('completed');
                    stepEl.classList.remove('active');
                } else if (i === step) {
                    stepEl.classList.add('active');
                    stepEl.classList.remove('completed');
                } else {
                    stepEl.classList.remove('active', 'completed');
                }
            }
        }

        // AIç”Ÿæˆæ–‡æ¡£
        async function generateDocument() {
            if (isGenerating) return;
            
            isGenerating = true;
            const statusEl = document.getElementById('generating-status');
            const progressBar = document.getElementById('progress-bar');
            const editorContent = document.getElementById('editor-content');
            
            statusEl.classList.remove('hidden');
            progressBar.style.width = '0%';
            
            // æ¨¡æ‹Ÿç”Ÿæˆè¿‡ç¨‹
            let progress = 0;
            const progressInterval = setInterval(() => {
                progress += Math.random() * 15;
                if (progress > 90) progress = 90;
                progressBar.style.width = `${progress}%`;
            }, 500);
            
            // æ¨¡æ‹ŸAIç”Ÿæˆå†…å®¹
            setTimeout(() => {
                clearInterval(progressInterval);
                progressBar.style.width = '100%';
                
                // ç”Ÿæˆå†…å®¹
                const generatedContent = generateAIContent();
                editorContent.innerHTML = generatedContent;
                
                setTimeout(() => {
                    statusEl.classList.add('hidden');
                    isGenerating = false;
                    updateProgress(3);
                    showToast('æ–‡æ¡£ç”Ÿæˆå®Œæˆï¼', 'success');
                }, 500);
            }, 3000);
        }

        // ç”ŸæˆAIå†…å®¹
        function generateAIContent() {
            const template = docTemplates[currentDocType];
            let content = `<h1 class="text-2xl font-bold text-gray-800 mb-4">${template.title}</h1>`;
            
            if (currentDocType === 'design-report') {
                content += `
                    <h2 class="text-xl font-semibold text-gray-800 mt-6 mb-3">1. æ¦‚è¿°</h2>
                    <p class="text-gray-700 mb-3">æœ¬æ¶æ„è®¾è®¡æŠ¥å‘Šè¯¦ç»†é˜è¿°äº†ç³»ç»Ÿçš„æ•´ä½“æ¶æ„æ–¹æ¡ˆï¼Œéµå¾ªå¾®æœåŠ¡æ¶æ„è®¾è®¡åŸåˆ™ï¼Œé‡‡ç”¨åˆ†å±‚æ¶æ„æ¨¡å¼ï¼Œç¡®ä¿ç³»ç»Ÿçš„é«˜å¯ç”¨æ€§ã€å¯æ‰©å±•æ€§å’Œå¯ç»´æŠ¤æ€§ã€‚</p>
                    
                    <h3 class="text-lg font-semibold text-gray-800 mt-4 mb-2">1.1 ç³»ç»ŸèƒŒæ™¯</h3>
                    <p class="text-gray-700 mb-3">éšç€ä¸šåŠ¡çš„å¿«é€Ÿå‘å±•ï¼Œç°æœ‰ç³»ç»Ÿæ¶æ„é¢ä¸´æ€§èƒ½ç“¶é¢ˆå’Œæ‰©å±•æ€§é™åˆ¶ã€‚ä¸ºæ»¡è¶³æœªæ¥3-5å¹´çš„ä¸šåŠ¡å¢é•¿éœ€æ±‚ï¼Œéœ€è¦å¯¹ç³»ç»Ÿæ¶æ„è¿›è¡Œå…¨é¢å‡çº§æ”¹é€ ã€‚</p>
                    
                    <h3 class="text-lg font-semibold text-gray-800 mt-4 mb-2">1.2 è®¾è®¡ç›®æ ‡</h3>
                    <ul class="list-disc list-inside text-gray-700 space-y-1 mb-3">
                        <li>æ”¯æŒ10ä¸‡+ QPSçš„å¹¶å‘è®¿é—®</li>
                        <li>ç³»ç»Ÿå¯ç”¨æ€§è¾¾åˆ°99.99%</li>
                        <li>å“åº”æ—¶é—´P99 < 200ms</li>
                        <li>æ”¯æŒæ¨ªå‘å¼¹æ€§æ‰©å±•</li>
                        <li>å®ç°æœåŠ¡è‡ªæ²»å’Œæ•…éšœéš”ç¦»</li>
                    </ul>
                    
                    <h2 class="text-xl font-semibold text-gray-800 mt-6 mb-3">2. ä¸šåŠ¡æ¶æ„</h2>
                    <p class="text-gray-700 mb-3">ä¸šåŠ¡æ¶æ„é‡‡ç”¨é¢†åŸŸé©±åŠ¨è®¾è®¡(DDD)æ–¹æ³•ï¼Œå°†ç³»ç»Ÿåˆ’åˆ†ä¸ºå¤šä¸ªä¸šåŠ¡é¢†åŸŸï¼Œæ¯ä¸ªé¢†åŸŸåŒ…å«ç‹¬ç«‹çš„ä¸šåŠ¡èƒ½åŠ›å’Œæ•°æ®æ¨¡å‹ã€‚</p>
                    
                    <h3 class="text-lg font-semibold text-gray-800 mt-4 mb-2">2.1 æ ¸å¿ƒä¸šåŠ¡é¢†åŸŸ</h3>
                    <ul class="list-disc list-inside text-gray-700 space-y-1 mb-3">
                        <li><strong>ç”¨æˆ·åŸŸï¼š</strong>ç”¨æˆ·æ³¨å†Œã€è®¤è¯ã€æƒé™ç®¡ç†</li>
                        <li><strong>è®¢å•åŸŸï¼š</strong>è®¢å•åˆ›å»ºã€æ”¯ä»˜ã€å±¥çº¦</li>
                        <li><strong>äº§å“åŸŸï¼š</strong>äº§å“ç®¡ç†ã€åº“å­˜ç®¡ç†ã€ä»·æ ¼ç­–ç•¥</li>
                        <li><strong>è¥é”€åŸŸï¼š</strong>ä¿ƒé”€æ´»åŠ¨ã€ä¼˜æƒ åˆ¸ã€ç§¯åˆ†ä½“ç³»</li>
                    </ul>
                    
                    <div class="mt-6 p-4 bg-green-50 border-l-4 border-green-500 rounded">
                        <p class="text-sm text-green-700">
                            <strong>AIå»ºè®®ï¼š</strong>åŸºäºæ‚¨çš„ç³»ç»Ÿç‰¹å¾ï¼Œå»ºè®®é‡‡ç”¨äº‹ä»¶é©±åŠ¨æ¶æ„(EDA)æ¥å®ç°é¢†åŸŸé—´çš„è§£è€¦é€šä¿¡ã€‚
                        </p>
                    </div>
                    
                    <h2 class="text-xl font-semibold text-gray-800 mt-6 mb-3">3. åº”ç”¨æ¶æ„</h2>
                    <p class="text-gray-700 mb-3">åº”ç”¨æ¶æ„é‡‡ç”¨å¾®æœåŠ¡æ¶æ„æ¨¡å¼ï¼Œæ¯ä¸ªæœåŠ¡ç‹¬ç«‹éƒ¨ç½²ã€ç‹¬ç«‹æ‰©å±•ã€ç‹¬ç«‹æ¼”è¿›ã€‚</p>
                    
                    <h3 class="text-lg font-semibold text-gray-800 mt-4 mb-2">3.1 æœåŠ¡åˆ†å±‚</h3>
                    <ul class="list-disc list-inside text-gray-700 space-y-1 mb-3">
                        <li><strong>æ¥å…¥å±‚ï¼š</strong>APIç½‘å…³ã€è´Ÿè½½å‡è¡¡ã€é™æµç†”æ–­</li>
                        <li><strong>ä¸šåŠ¡æœåŠ¡å±‚ï¼š</strong>æ ¸å¿ƒä¸šåŠ¡é€»è¾‘å®ç°</li>
                        <li><strong>åŸºç¡€æœåŠ¡å±‚ï¼š</strong>é€šç”¨èƒ½åŠ›æœåŠ¡ï¼ˆæ¶ˆæ¯ã€ç¼“å­˜ã€å­˜å‚¨ï¼‰</li>
                        <li><strong>æ•°æ®å±‚ï¼š</strong>æ•°æ®åº“ã€æ¶ˆæ¯é˜Ÿåˆ—ã€ç¼“å­˜</li>
                    </ul>`;
            }
            
            return content;
        }

        // AIè¾…åŠ©
        function aiAssist() {
            const selection = window.getSelection();
            const selectedText = selection.toString();
            
            if (selectedText) {
                // ä¼˜åŒ–é€‰ä¸­çš„æ–‡æœ¬
                const optimizedText = `<mark class="bg-yellow-200">${selectedText}</mark> <span class="text-blue-600">[AIä¼˜åŒ–å»ºè®®ï¼šå¯ä»¥æ·»åŠ æ›´å¤šæŠ€æœ¯ç»†èŠ‚è¯´æ˜]</span>`;
                document.execCommand('insertHTML', false, optimizedText);
                showToast('AIå·²ä¸ºæ‚¨ä¼˜åŒ–é€‰ä¸­çš„å†…å®¹', 'success');
            } else {
                // ç”Ÿæˆæ–°å†…å®¹
                const suggestions = [
                    'å»ºè®®æ·»åŠ ï¼šç³»ç»Ÿçš„éåŠŸèƒ½æ€§éœ€æ±‚è¯´æ˜',
                    'å»ºè®®æ·»åŠ ï¼šå…³é”®æŠ€æœ¯é€‰å‹çš„å†³ç­–ä¾æ®',
                    'å»ºè®®æ·»åŠ ï¼šæ€§èƒ½åŸºå‡†æµ‹è¯•ç»“æœ',
                    'å»ºè®®æ·»åŠ ï¼šå®¹ç¾å’Œå¤‡ä»½ç­–ç•¥'
                ];
                
                const suggestion = suggestions[Math.floor(Math.random() * suggestions.length)];
                const newContent = `<div class="mt-4 p-3 bg-purple-50 border-l-4 border-purple-500 rounded">
                    <p class="text-sm text-purple-700"><strong>AIå»ºè®®ï¼š</strong>${suggestion}</p>
                </div>`;
                
                document.getElementById('editor-content').insertAdjacentHTML('beforeend', newContent);
                showToast('AIå·²ä¸ºæ‚¨ç”Ÿæˆå»ºè®®å†…å®¹', 'success');
            }
        }

        // æ ¼å¼åŒ–æ–‡æœ¬
        function formatText(format) {
            switch (format) {
                case 'bold':
                    document.execCommand('bold', false, null);
                    break;
                case 'italic':
                    document.execCommand('italic', false, null);
                    break;
                case 'heading':
                    document.execCommand('formatBlock', false, 'h2');
                    break;
                case 'list':
                    document.execCommand('insertUnorderedList', false, null);
                    break;
            }
        }

        // æ’å…¥æ¨¡æ¿
        function insertTemplate() {
            const templates = {
                'architecture-principles': `
                    <h3 class="text-lg font-semibold text-gray-800 mt-4 mb-2">æ¶æ„åŸåˆ™</h3>
                    <ul class="list-disc list-inside text-gray-700 space-y-1">
                        <li>é«˜å†…èšä½è€¦åˆï¼šæœåŠ¡è¾¹ç•Œæ¸…æ™°ï¼Œä¾èµ–å…³ç³»ç®€å•</li>
                        <li>æœåŠ¡è‡ªæ²»ï¼šæ¯ä¸ªæœåŠ¡ç‹¬ç«‹éƒ¨ç½²ã€ç‹¬ç«‹æ‰©å±•</li>
                        <li>æ•…éšœéš”ç¦»ï¼šå•ä¸ªæœåŠ¡æ•…éšœä¸å½±å“æ•´ä½“ç³»ç»Ÿ</li>
                        <li>æ•°æ®ä¸€è‡´æ€§ï¼šé‡‡ç”¨æœ€ç»ˆä¸€è‡´æ€§æ¨¡å‹</li>
                    </ul>`,
                'tech-stack': `
                    <h3 class="text-lg font-semibold text-gray-800 mt-4 mb-2">æŠ€æœ¯æ ˆ</h3>
                    <table class="min-w-full border border-gray-300 mt-2">
                        <tr class="bg-gray-100">
                            <th class="border p-2 text-left">å±‚çº§</th>
                            <th class="border p-2 text-left">æŠ€æœ¯é€‰å‹</th>
                        </tr>
                        <tr>
                            <td class="border p-2">å‰ç«¯</td>
                            <td class="border p-2">Vue 3 + TypeScript</td>
                        </tr>
                        <tr>
                            <td class="border p-2">åç«¯</td>
                            <td class="border p-2">Spring Cloud + Kotlin</td>
                        </tr>
                        <tr>
                            <td class="border p-2">æ•°æ®åº“</td>
                            <td class="border p-2">MySQL + Redis</td>
                        </tr>
                    </table>`
            };
            
            const template = templates['architecture-principles'];
            document.getElementById('editor-content').insertAdjacentHTML('beforeend', template);
            showToast('æ¨¡æ¿å·²æ’å…¥', 'success');
        }

        // åº”ç”¨AIå»ºè®®
        function applyAISuggestion(suggestionType) {
            if (suggestionType === 'template1') {
                selectDocType('design-report');
                showToast('å·²åº”ç”¨æ¨èæ¨¡æ¿', 'success');
            } else if (suggestionType === 'content1') {
                const performanceSection = `
                    <h3 class="text-lg font-semibold text-gray-800 mt-4 mb-2">æ€§èƒ½æŒ‡æ ‡åŸºçº¿</h3>
                    <ul class="list-disc list-inside text-gray-700 space-y-1">
                        <li>APIå“åº”æ—¶é—´: P50 < 50ms, P99 < 200ms</li>
                        <li>ååé‡: å•æœº QPS > 1000</li>
                        <li>å¹¶å‘è¿æ¥æ•°: > 10000</li>
                        <li>CPUä½¿ç”¨ç‡: < 70%</li>
                        <li>å†…å­˜ä½¿ç”¨ç‡: < 80%</li>
                    </ul>`;
                document.getElementById('editor-content').insertAdjacentHTML('beforeend', performanceSection);
                showToast('æ€§èƒ½æŒ‡æ ‡å·²æ·»åŠ ', 'success');
            }
        }

        // æ·»åŠ ç« èŠ‚
        function addChapter() {
            const chapterName = prompt('è¯·è¾“å…¥ç« èŠ‚åç§°ï¼š');
            if (chapterName) {
                const chapterList = document.getElementById('chapter-list');
                const newChapter = document.createElement('div');
                newChapter.className = 'chapter-item';
                newChapter.draggable = true;
                newChapter.innerHTML = `
                    <div class="flex items-center justify-between">
                        <span class="text-sm font-medium">${chapterName}</span>
                        <button onclick="editChapter(${Date.now()})" class="text-gray-500 hover:text-gray-700">
                            âœï¸
                        </button>
                    </div>`;
                chapterList.appendChild(newChapter);
                initDragAndDrop();
                showToast('ç« èŠ‚å·²æ·»åŠ ', 'success');
            }
        }

        // ç¼–è¾‘ç« èŠ‚
        function editChapter(chapterId) {
            const newName = prompt('è¯·è¾“å…¥æ–°çš„ç« èŠ‚åç§°ï¼š');
            if (newName) {
                event.target.parentElement.previousElementSibling.textContent = newName;
                showToast('ç« èŠ‚å·²æ›´æ–°', 'success');
            }
        }

        // ä¿å­˜æ–‡æ¡£
        function saveDocument() {
            const content = document.getElementById('editor-content').innerHTML;
            documentContent[currentDocType] = content;
            localStorage.setItem('adf_document', JSON.stringify(documentContent));
            showToast('æ–‡æ¡£å·²ä¿å­˜', 'success');
        }

        // é¢„è§ˆæ–‡æ¡£
        function previewDocument() {
            const content = document.getElementById('editor-content').innerHTML;
            const previewWindow = window.open('', '_blank');
            previewWindow.document.write(`
                <!DOCTYPE html>
                <html>
                <head>
                    <title>æ–‡æ¡£é¢„è§ˆ</title>
                    <style>
                        block { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif; padding: 40px; max-width: 800px; margin: 0 auto; }
                        h1 { color: #1f2937; }
                        h2 { color: #374151; margin-top: 24px; }
                        h3 { color: #4b5563; margin-top: 16px; }
                        p { line-height: 1.6; color: #6b7280; }
                        ul { color: #6b7280; }
                        .bg-blue-50 { background: #eff6ff; padding: 16px; border-left: 4px solid #3b82f6; border-radius: 4px; margin: 16px 0; }
                        .bg-green-50 { background: #f0fdf4; padding: 16px; border-left: 4px solid #10b981; border-radius: 4px; margin: 16px 0; }
                        .bg-purple-50 { background: #faf5ff; padding: 16px; border-left: 4px solid #9333ea; border-radius: 4px; margin: 16px 0; }
                        mark { background: #fef3c7; padding: 2px 4px; }
                    </style>
                </head>
                <block>${content}</block>
                </html>
            `);
            updateProgress(4);
        }

        // æŸ¥çœ‹ç‰ˆæœ¬
        function viewVersion(version) {
            showToast(`æ­£åœ¨æŸ¥çœ‹ç‰ˆæœ¬ ${version}`, 'info');
        }

        // åˆå§‹åŒ–æ‹–æ‹½åŠŸèƒ½
        function initDragAndDrop() {
            const chapters = document.querySelectorAll('.chapter-item');
            let draggedItem = null;
            
            chapters.forEach(chapter => {
                chapter.addEventListener('dragstart', function(e) {
                    draggedItem = this;
                    this.classList.add('dragging');
                });
                
                chapter.addEventListener('dragend', function(e) {
                    this.classList.remove('dragging');
                });
                
                chapter.addEventListener('dragover', function(e) {
                    e.preventDefault();
                    if (this !== draggedItem) {
                        const rect = this.getBoundingClientRect();
                        const y = e.clientY - rect.top;
                        if (y < rect.height / 2) {
                            this.parentNode.insertBefore(draggedItem, this);
                        } else {
                            this.parentNode.insertBefore(draggedItem, this.nextSibling);
                        }
                    }
                });
            });
        }

        // åˆå§‹åŒ–
        document.addEventListener('DOMContentLoaded', function() {
            initDragAndDrop();
            
            // æ¢å¤ä¿å­˜çš„å†…å®¹
            const savedContent = localStorage.getItem('adf_document');
            if (savedContent) {
                documentContent = JSON.parse(savedContent);
            }
            
            // è‡ªåŠ¨ä¿å­˜
            setInterval(() => {
                if (!isGenerating) {
                    saveDocument();
                }
            }, 30000); // æ¯30ç§’è‡ªåŠ¨ä¿å­˜
            
            console.log('æ™ºèƒ½æ–‡æ¡£å·¥å‚å·²åˆå§‹åŒ–');
        });
    </script>
</body>
</html>