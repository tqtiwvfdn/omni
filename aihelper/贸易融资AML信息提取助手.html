<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>è²¿æ˜“èè³‡AMLä¿¡æ¯æå–åŠ©æ‰‹ - ä¸Šæµ·å•†æ¥­éŠ€è¡Œ</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body {
            min-height: 100vh;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            /* background: linear-gradient(135deg, #f0f4f8 0%, #e2e8f0 50%, #f0f4f8 100%); */
        }
        
        .liquid-glass {
            background: rgba(255, 255, 255, 0.85);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.3);
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
        }
        
        .liquid-glass-strong {
            /* background: rgba(255, 255, 255, 0.95); */
            backdrop-filter: blur(25px);
            border: 1px solid rgba(255, 255, 255, 0.4);
            box-shadow: 0 12px 40px rgba(0, 0, 0, 0.12);
        }
        
        .specular-highlight {
            position: relative;
            overflow: hidden;
        }
        
        .specular-highlight::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.4), transparent);
            transition: left 0.6s ease;
            pointer-events: none;
        }
        
        .specular-highlight:hover::before {
            left: 100%;
        }
        
        .upload-zone {
            border: 2px dashed rgba(234, 88, 12, 0.3);
            border-radius: 20px;
            padding: 48px 24px;
            text-align: center;
            background: rgba(234, 88, 12, 0.05);
            transition: all 0.3s ease;
            cursor: pointer;
            position: relative;
        }
        
        .upload-zone:hover {
            border-color: rgba(234, 88, 12, 0.5);
            background: rgba(234, 88, 12, 0.1);
            transform: translateY(-2px);
        }
        
        .upload-zone.dragover {
            border-color: rgba(34, 197, 94, 0.5);
            background: rgba(34, 197, 94, 0.1);
            transform: scale(1.02);
        }
        
        .upload-zone.has-file {
            border-color: rgba(34, 197, 94, 0.5);
            background: rgba(34, 197, 94, 0.1);
        }
        
        .doc-type-card {
            background: rgba(255, 255, 255, 0.9);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.3);
            border-radius: 12px;
            padding: 12px 16px;
            transition: all 0.3s cubic-bezier(0.25, 0.46, 0.45, 0.94);
            cursor: pointer;
        }
        
        .doc-type-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 24px rgba(0, 0, 0, 0.1);
            border-color: rgba(234, 88, 12, 0.3);
        }
        
        .doc-type-card.selected {
            border-color: rgba(234, 88, 12, 0.5);
            background: rgba(234, 88, 12, 0.1);
        }
        
        .message-bubble {
            max-width: 90%;
            word-wrap: break-word;
            animation: slideIn 0.3s ease-out;
        }
        
        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateY(10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        .user-message {
            background: linear-gradient(135deg, #ea580c 0%, #c2410c 100%);
            color: white;
            margin-left: auto;
            border-radius: 18px 18px 4px 18px;
        }
        
        .assistant-message {
            background: rgba(255, 255, 255, 0.95);
            color: #374151;
            margin-right: auto;
            border-radius: 18px 18px 18px 4px;
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.3);
        }
        
        .typing-indicator {
            display: flex;
            align-items: center;
            padding: 12px 16px;
            background: rgba(255, 255, 255, 0.95);
            border-radius: 18px 18px 18px 4px;
            margin-right: auto;
            max-width: 85%;
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.3);
        }
        
        .typing-dot {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background: #9ca3af;
            margin: 0 2px;
            animation: typing 1.4s infinite;
        }
        
        .typing-dot:nth-child(2) { animation-delay: 0.2s; }
        .typing-dot:nth-child(3) { animation-delay: 0.4s; }
        
        @keyframes typing {
            0%, 60%, 100% {
                transform: translateY(0);
                opacity: 0.4;
            }
            30% {
                transform: translateY(-10px);
                opacity: 1;
            }
        }
        
        .risk-badge {
            display: inline-flex;
            align-items: center;
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 600;
        }
        
        .risk-high {
            background: rgba(239, 68, 68, 0.1);
            color: #dc2626;
            border: 1px solid rgba(239, 68, 68, 0.3);
        }
        
        .risk-medium {
            background: rgba(245, 158, 11, 0.1);
            color: #d97706;
            border: 1px solid rgba(245, 158, 11, 0.3);
        }
        
        .risk-low {
            background: rgba(34, 197, 94, 0.1);
            color: #16a34a;
            border: 1px solid rgba(34, 197, 94, 0.3);
        }
        
        .extracted-field {
            background: rgba(255, 255, 255, 0.9);
            border: 1px solid rgba(0, 0, 0, 0.08);
            border-radius: 12px;
            padding: 12px 16px;
            transition: all 0.2s ease;
        }
        
        .extracted-field:hover {
            border-color: rgba(234, 88, 12, 0.3);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05);
        }
        
        .extracted-field.flagged {
            border-color: rgba(239, 68, 68, 0.5);
            background: rgba(239, 68, 68, 0.05);
        }
        
        .country-tag {
            display: inline-flex;
            align-items: center;
            padding: 4px 10px;
            border-radius: 6px;
            font-size: 12px;
            margin: 2px;
        }
        
        .country-safe {
            background: rgba(34, 197, 94, 0.1);
            color: #16a34a;
        }
        
        .country-watch {
            background: rgba(245, 158, 11, 0.1);
            color: #d97706;
        }
        
        .country-sanctioned {
            background: rgba(239, 68, 68, 0.1);
            color: #dc2626;
        }
        
        .step-indicator {
            display: flex;
            align-items: center;
            margin-bottom: 24px;
        }
        
        .step {
            display: flex;
            align-items: center;
            font-size: 14px;
            color: #6b7280;
        }
        
        .step.active {
            color: #ea580c;
            font-weight: 600;
        }
        
        .step.completed {
            color: #10b981;
        }
        
        .step-circle {
            width: 28px;
            height: 28px;
            border-radius: 50%;
            background: #e5e7eb;
            color: #6b7280;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 12px;
            font-weight: 600;
            margin-right: 8px;
        }
        
        .step.active .step-circle {
            background: #ea580c;
            color: white;
        }
        
        .step.completed .step-circle {
            background: #10b981;
            color: white;
        }
        
        .step-divider {
            width: 40px;
            height: 2px;
            background: #e5e7eb;
            margin: 0 12px;
        }
        
        .step.completed + .step-divider {
            background: #10b981;
        }
        
        .file-preview {
            display: flex;
            align-items: center;
            justify-content: space-between;
            background: rgba(255, 255, 255, 0.9);
            border: 1px solid rgba(0, 0, 0, 0.1);
            border-radius: 12px;
            padding: 16px;
            margin-top: 16px;
        }
        
        .source-reference {
            background: rgba(234, 88, 12, 0.1);
            border: 1px solid rgba(234, 88, 12, 0.2);
            border-radius: 8px;
            padding: 8px 12px;
            margin: 8px 0;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .source-reference:hover {
            background: rgba(234, 88, 12, 0.15);
            transform: translateY(-1px);
        }
        
        .floating-button {
            transform: translateY(0);
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }
        
        .floating-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 12px 40px rgba(0, 0, 0, 0.15);
        }
        
        .chat-input {
            background: rgba(255, 255, 255, 0.9);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.3);
            border-radius: 16px;
            padding: 12px 16px;
            outline: none;
            transition: all 0.3s ease;
        }
        
        .chat-input:focus {
            border-color: rgba(234, 88, 12, 0.5);
            box-shadow: 0 0 0 3px rgba(234, 88, 12, 0.1);
        }
        
        .action-btn {
            display: flex;
            align-items: center;
            gap: 4px;
            padding: 6px 12px;
            border-radius: 8px;
            border: 1px solid rgba(0, 0, 0, 0.1);
            background: rgba(255, 255, 255, 0.8);
            color: #6b7280;
            font-size: 12px;
            cursor: pointer;
            transition: all 0.2s ease;
        }
        
        .action-btn:hover {
            background: rgba(255, 255, 255, 0.95);
            border-color: rgba(234, 88, 12, 0.3);
            color: #374151;
        }
        
        .action-btn.active {
            background: rgba(234, 88, 12, 0.1);
            border-color: rgba(234, 88, 12, 0.3);
            color: #ea580c;
        }
        
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.5);
            backdrop-filter: blur(4px);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 1000;
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s ease;
        }
        
        .modal-overlay.show {
            opacity: 1;
            visibility: visible;
        }
        
        .modal-content {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(25px);
            border: 1px solid rgba(255, 255, 255, 0.3);
            border-radius: 20px;
            max-width: 700px;
            width: 90%;
            max-height: 85vh;
            margin: 20px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.2);
            transform: scale(0.9);
            transition: transform 0.3s ease;
            overflow: hidden;
        }
        
        .modal-overlay.show .modal-content {
            transform: scale(1);
        }
        
        .highlight {
            background: linear-gradient(135deg, #fef3c7 0%, #fde68a 100%);
            padding: 2px 4px;
            border-radius: 4px;
            font-weight: 600;
        }
        
        .toast {
            position: fixed;
            top: 20px;
            right: 20px;
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.3);
            border-radius: 12px;
            padding: 16px 20px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
            transform: translateX(400px);
            transition: transform 0.3s ease;
            z-index: 1001;
            min-width: 300px;
        }
        
        .toast.show { transform: translateX(0); }
        .toast.success { border-left: 4px solid #10b981; }
        .toast.error { border-left: 4px solid #ef4444; }
        .toast.warning { border-left: 4px solid #f59e0b; }
        .toast.info { border-left: 4px solid #ea580c; }
        
        .progress-bar {
            height: 4px;
            background: #e5e7eb;
            border-radius: 2px;
            overflow: hidden;
        }
        
        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #ea580c, #f97316);
            border-radius: 2px;
            transition: width 0.3s ease;
        }
        
        .aml-result-card {
            background: rgba(255, 255, 255, 0.95);
            border: 1px solid rgba(0, 0, 0, 0.08);
            border-radius: 16px;
            overflow: hidden;
            transition: all 0.3s ease;
        }
        
        .aml-result-card:hover {
            box-shadow: 0 8px 24px rgba(0, 0, 0, 0.1);
        }
        
        .entity-card {
            background: rgba(255, 255, 255, 0.9);
            border: 1px solid rgba(0, 0, 0, 0.08);
            border-radius: 12px;
            padding: 16px;
            margin-bottom: 12px;
            transition: all 0.2s ease;
        }
        
        .entity-card:hover {
            border-color: rgba(234, 88, 12, 0.3);
        }
        
        .entity-card.alert {
            border-color: rgba(239, 68, 68, 0.5);
            background: rgba(239, 68, 68, 0.03);
        }
        
        .screening-status {
            display: inline-flex;
            align-items: center;
            gap: 6px;
            padding: 4px 10px;
            border-radius: 6px;
            font-size: 12px;
            font-weight: 500;
        }
        
        .status-clear {
            background: rgba(34, 197, 94, 0.1);
            color: #16a34a;
        }
        
        .status-pending {
            background: rgba(245, 158, 11, 0.1);
            color: #d97706;
        }
        
        .status-alert {
            background: rgba(239, 68, 68, 0.1);
            color: #dc2626;
        }
    </style>
</head>
<body class="h-screen flex flex-col">
    <!-- ä¸»ç•Œé¢ -->
    <div class="flex-1 flex flex-col w-full overflow-hidden">
        <!-- é ­éƒ¨ -->
        <div class="liquid-glass-strong p-4 flex items-center justify-between">
            <div class="flex items-center">
                <div class="w-12 h-12 rounded-full mr-4 bg-gradient-to-br from-orange-500 to-orange-600 flex items-center justify-center">
                    <span class="text-white text-xl">ğŸ›¡ï¸</span>
                </div>
                <div>
                    <h3 class="text-lg font-semibold text-gray-800">è²¿æ˜“èè³‡AMLä¿¡æ¯æå–åŠ©æ‰‹</h3>
                    <p class="text-sm text-gray-500">å·¥è™Ÿ A0002 Â· ç¥¨æ“šè™•ç†ä¸­å¿ƒ BPC Â· åæ´—éŒ¢åˆè¦</p>
                </div>
            </div>
            <div class="flex items-center gap-3">
                <button onclick="showHistory()" class="liquid-glass floating-button rounded-lg px-4 py-2 text-sm font-medium text-gray-700 specular-highlight">
                    ğŸ“‹ æ­·å²è¨˜éŒ„
                </button>
                <button onclick="resetWizard()" class="liquid-glass floating-button rounded-lg px-4 py-2 text-sm font-medium text-gray-700 specular-highlight">
                    âœ¨ æ–°å»ºæå–
                </button>
            </div>
        </div>
        
        <!-- æ¶ˆæ¯å€åŸŸ -->
        <div id="messages-container" class="flex-1 liquid-glass-strong p-6 overflow-y-auto">
            <!-- åš®å°ç•Œé¢ -->
            <div id="wizard-interface">
                <!-- æ­¥é©ŸæŒ‡ç¤ºå™¨ -->
                <div class="step-indicator">
                    <div class="step active" id="step-1">
                        <div class="step-circle">1</div>
                        <span>ä¸Šå‚³å–®æ“š</span>
                    </div>
                    <div class="step-divider"></div>
                    <div class="step" id="step-2">
                        <div class="step-circle">2</div>
                        <span>é¸æ“‡é¡å‹</span>
                    </div>
                    <div class="step-divider"></div>
                    <div class="step" id="step-3">
                        <div class="step-circle">3</div>
                        <span>AIæå–</span>
                    </div>
                    <div class="step-divider"></div>
                    <div class="step" id="step-4">
                        <div class="step-circle">4</div>
                        <span>å¯©æ ¸ç¢ºèª</span>
                    </div>
                </div>
                
                <!-- åŠ©æ‰‹ä»‹ç´¹ -->
                <div class="message-bubble assistant-message p-6 mb-6">
                    <div class="prose prose-sm max-w-none text-gray-700">
                        <h3 class="text-lg font-semibold text-gray-800 mb-3">ğŸ›¡ï¸ æ­¡è¿ä½¿ç”¨è²¿æ˜“èè³‡AMLä¿¡æ¯æå–åŠ©æ‰‹</h3>
                        <p class="mb-3">æˆ‘èƒ½å¤ å¾è²¿æ˜“èè³‡å–®æ“šä¸­è‡ªå‹•æå–åæ´—éŒ¢(AML)æ‰€éœ€çš„é—œéµä¿¡æ¯ï¼Œå”åŠ©æ‚¨å¿«é€Ÿå®Œæˆåˆè¦å¯©æŸ¥ï¼Œæå‡å·¥ä½œæ•ˆç‡ã€‚</p>
                        <div class="grid grid-cols-1 md:grid-cols-4 gap-4 mt-4">
                            <div class="flex items-center">
                                <div class="w-10 h-10 bg-orange-100 rounded-lg flex items-center justify-center mr-3">
                                    <span class="text-orange-600 text-lg">ğŸ“„</span>
                                </div>
                                <div>
                                    <div class="font-medium text-sm">æ™ºèƒ½æå–</div>
                                    <div class="text-xs text-gray-500">OCR+NLPæŠ€è¡“</div>
                                </div>
                            </div>
                            <div class="flex items-center">
                                <div class="w-10 h-10 bg-red-100 rounded-lg flex items-center justify-center mr-3">
                                    <span class="text-red-600 text-lg">ğŸ”</span>
                                </div>
                                <div>
                                    <div class="font-medium text-sm">åå–®ç¯©æŸ¥</div>
                                    <div class="text-xs text-gray-500">åˆ¶è£åå–®æ¯”å°</div>
                                </div>
                            </div>
                            <div class="flex items-center">
                                <div class="w-10 h-10 bg-yellow-100 rounded-lg flex items-center justify-center mr-3">
                                    <span class="text-yellow-600 text-lg">ğŸŒ</span>
                                </div>
                                <div>
                                    <div class="font-medium text-sm">åœ‹å®¶é¢¨éšª</div>
                                    <div class="text-xs text-gray-500">é«˜é¢¨éšªåœ°å€è­˜åˆ¥</div>
                                </div>
                            </div>
                            <div class="flex items-center">
                                <div class="w-10 h-10 bg-green-100 rounded-lg flex items-center justify-center mr-3">
                                    <span class="text-green-600 text-lg">ğŸ“Š</span>
                                </div>
                                <div>
                                    <div class="font-medium text-sm">å ±å‘Šç”Ÿæˆ</div>
                                    <div class="text-xs text-gray-500">æ¨™æº–åŒ–è¼¸å‡º</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- æ­¥é©Ÿ1: æ–‡æª”ä¸Šå‚³ -->
                <div id="upload-step" class="step-content">
                    <h3 class="text-lg font-semibold text-gray-800 mb-4">ç¬¬ä¸€æ­¥ï¼šä¸Šå‚³è²¿æ˜“èè³‡å–®æ“š</h3>
                    <div class="upload-zone" id="upload-zone" onclick="triggerFileInput()" ondrop="handleDrop(event)" ondragover="handleDragOver(event)" ondragleave="handleDragLeave(event)">
                        <div id="upload-content">
                            <svg class="w-16 h-16 mx-auto mb-4 text-orange-500" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"></path>
                            </svg>
                            <h4 class="text-xl font-semibold text-gray-700 mb-2">æ‹–æ‹½å–®æ“šåˆ°é€™è£¡</h4>
                            <p class="text-gray-500 mb-4">æˆ–é»æ“Šé¸æ“‡æ–‡ä»¶ä¸Šå‚³ï¼ˆæ”¯æŒæ‰¹é‡ä¸Šå‚³ï¼‰</p>
                            <div class="flex flex-wrap justify-center gap-2 text-xs text-gray-400">
                                <span class="bg-gray-100 px-2 py-1 rounded">PDF</span>
                                <span class="bg-gray-100 px-2 py-1 rounded">TIFF</span>
                                <span class="bg-gray-100 px-2 py-1 rounded">JPG/PNG</span>
                                <span class="bg-gray-100 px-2 py-1 rounded">Word</span>
                                <span class="bg-gray-100 px-2 py-1 rounded">Excel</span>
                                <span class="bg-gray-100 px-2 py-1 rounded">æœ€å¤§50MB</span>
                            </div>
                        </div>
                        <input type="file" id="file-input" style="display: none;" accept=".pdf,.tiff,.tif,.jpg,.jpeg,.png,.doc,.docx,.xls,.xlsx" multiple onchange="handleFileUpload(this)">
                    </div>
                    
                    <!-- æ–‡ä»¶é è¦½å€åŸŸ -->
                    <div id="file-preview-area" style="display: none;"></div>
                </div>
                
                <!-- æ­¥é©Ÿ2: å–®æ“šé¡å‹é¸æ“‡ -->
                <div id="doctype-step" class="step-content" style="display: none;">
                    <h3 class="text-lg font-semibold text-gray-800 mb-4">ç¬¬äºŒæ­¥ï¼šç¢ºèªå–®æ“šé¡å‹</h3>
                    <p class="text-gray-600 mb-4">AIå·²è‡ªå‹•è­˜åˆ¥å–®æ“šé¡å‹ï¼Œè«‹ç¢ºèªæˆ–èª¿æ•´ï¼š</p>
                    
                    <div class="grid grid-cols-2 md:grid-cols-4 gap-3 mb-6">
                        <div class="doc-type-card selected" onclick="selectDocType(this, 'lc')">
                            <div class="flex items-center">
                                <span class="text-lg mr-2">ğŸ“œ</span>
                                <span class="text-sm font-medium">ä¿¡ç”¨è­‰ L/C</span>
                            </div>
                        </div>
                        <div class="doc-type-card" onclick="selectDocType(this, 'invoice')">
                            <div class="flex items-center">
                                <span class="text-lg mr-2">ğŸ§¾</span>
                                <span class="text-sm font-medium">å•†æ¥­ç™¼ç¥¨</span>
                            </div>
                        </div>
                        <div class="doc-type-card" onclick="selectDocType(this, 'bl')">
                            <div class="flex items-center">
                                <span class="text-lg mr-2">ğŸš¢</span>
                                <span class="text-sm font-medium">æå–® B/L</span>
                            </div>
                        </div>
                        <div class="doc-type-card" onclick="selectDocType(this, 'packing')">
                            <div class="flex items-center">
                                <span class="text-lg mr-2">ğŸ“¦</span>
                                <span class="text-sm font-medium">è£ç®±å–®</span>
                            </div>
                        </div>
                        <div class="doc-type-card" onclick="selectDocType(this, 'insurance')">
                            <div class="flex items-center">
                                <span class="text-lg mr-2">ğŸ›¡ï¸</span>
                                <span class="text-sm font-medium">ä¿éšªå–®</span>
                            </div>
                        </div>
                        <div class="doc-type-card" onclick="selectDocType(this, 'coo')">
                            <div class="flex items-center">
                                <span class="text-lg mr-2">ğŸ›ï¸</span>
                                <span class="text-sm font-medium">åŸç”¢åœ°è­‰</span>
                            </div>
                        </div>
                        <div class="doc-type-card" onclick="selectDocType(this, 'draft')">
                            <div class="flex items-center">
                                <span class="text-lg mr-2">ğŸ’µ</span>
                                <span class="text-sm font-medium">åŒ¯ç¥¨</span>
                            </div>
                        </div>
                        <div class="doc-type-card" onclick="selectDocType(this, 'other')">
                            <div class="flex items-center">
                                <span class="text-lg mr-2">ğŸ“‹</span>
                                <span class="text-sm font-medium">å…¶ä»–å–®æ“š</span>
                            </div>
                        </div>
                    </div>
                    
                    <!-- é—œè¯äº¤æ˜“ä¿¡æ¯ -->
                    <div class="bg-orange-50 rounded-xl p-4 mb-6">
                        <h4 class="font-medium text-gray-800 mb-3">ğŸ“ é—œè¯äº¤æ˜“ä¿¡æ¯ï¼ˆå¯é¸ï¼‰</h4>
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                            <div>
                                <label class="block text-sm text-gray-600 mb-1">ä¿¡ç”¨è­‰ç·¨è™Ÿ</label>
                                <input type="text" id="lc-number" class="w-full px-3 py-2 border border-gray-200 rounded-lg text-sm focus:outline-none focus:border-orange-400" placeholder="ä¾‹ï¼šLC2024HK00123">
                            </div>
                            <div>
                                <label class="block text-sm text-gray-600 mb-1">å®¢æˆ¶ç·¨è™Ÿ</label>
                                <input type="text" id="customer-id" class="w-full px-3 py-2 border border-gray-200 rounded-lg text-sm focus:outline-none focus:border-orange-400" placeholder="ä¾‹ï¼šCIF00012345">
                            </div>
                        </div>
                    </div>
                    
                    <div class="flex justify-center gap-4">
                        <button onclick="goToStep(1)" class="liquid-glass floating-button rounded-lg px-6 py-2 text-sm font-medium text-gray-700 specular-highlight">
                            â† ä¸Šä¸€æ­¥
                        </button>
                        <button onclick="startExtraction()" class="bg-orange-500 text-white rounded-lg px-6 py-2 text-sm font-medium hover:bg-orange-600 transition-colors">
                            é–‹å§‹AIæå– â†’
                        </button>
                    </div>
                </div>
            </div>
            
            <!-- èŠå¤©å°è©±å€åŸŸ -->
            <div id="chat-area" style="display: none;"></div>
        </div>
        
        <!-- è¼¸å…¥å€åŸŸ -->
        <div id="input-area" class="liquid-glass-strong p-4" style="display: none;">
            <div class="flex items-end space-x-3">
                <div class="flex-1">
                    <input type="text" 
                           id="message-input"
                           placeholder="è¼¸å…¥å•é¡Œæˆ–æŒ‡ä»¤ï¼Œä¾‹å¦‚ï¼šé‡æ–°æå–ç”³è«‹äººä¿¡æ¯..."
                           class="w-full chat-input"
                           onkeypress="if(event.key==='Enter') sendMessage()">
                </div>
                <button onclick="sendMessage()" 
                        class="liquid-glass floating-button rounded-lg p-3 specular-highlight bg-orange-500 text-white">
                    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 19l9 2-9-18-9 18 9-2zm0 0v-8"></path>
                    </svg>
                </button>
            </div>
        </div>
    </div>

    <!-- çŸ¥è­˜æº¯æºå½ˆçª— -->
    <div id="source-modal" class="modal-overlay">
        <div class="modal-content">
            <div class="flex items-center justify-between p-6 border-b border-gray-200/50">
                <h3 class="text-lg font-semibold text-gray-800">ğŸ“ æ•¸æ“šä¾†æºè¿½æº¯</h3>
                <button onclick="closeSourceModal()" class="text-gray-500 hover:text-gray-700">
                    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                    </svg>
                </button>
            </div>
            
            <div class="p-6 overflow-y-auto max-h-96">
                <div class="mb-6">
                    <h4 class="font-semibold text-gray-800 mb-2">ğŸ“„ åŸæ–‡å®šä½</h4>
                    <div class="bg-gray-50 rounded-lg p-4">
                        <p class="text-sm text-gray-600 mb-2">
                            <span class="font-medium">æ–‡æª”ï¼š</span>
                            <span id="source-doc">Commercial_Invoice_2024.pdf</span>
                        </p>
                        <p class="text-sm text-gray-600 mb-2">
                            <span class="font-medium">é ç¢¼ï¼š</span>
                            <span id="source-page">ç¬¬ 1 é </span>
                        </p>
                        <p class="text-sm text-gray-600">
                            <span class="font-medium">ä½ç½®ï¼š</span>
                            <span id="source-location">å·¦ä¸Šè§’å€åŸŸ</span>
                        </p>
                    </div>
                </div>
                
                <div class="mb-6">
                    <h4 class="font-semibold text-gray-800 mb-2">ğŸ“ åŸæ–‡å…§å®¹</h4>
                    <div class="bg-orange-50 rounded-lg p-4">
                        <div id="source-content" class="text-sm text-gray-700 leading-relaxed font-mono">
                            Applicant: ABC Trading Co., Ltd.<br>
                            Address: 123 Main Street, Hong Kong
                        </div>
                    </div>
                </div>
                
                <div>
                    <h4 class="font-semibold text-gray-800 mb-2">ğŸ” æå–ç½®ä¿¡åº¦</h4>
                    <div class="flex items-center gap-4">
                        <div class="flex-1">
                            <div class="progress-bar">
                                <div class="progress-fill" style="width: 95%"></div>
                            </div>
                        </div>
                        <span class="text-sm font-semibold text-green-600" id="confidence-rate">95%</span>
                    </div>
                </div>
            </div>
            
            <div class="flex items-center justify-end p-6 border-t border-gray-200/50">
                <button onclick="closeSourceModal()" class="bg-orange-500 text-white rounded-lg px-4 py-2 text-sm font-medium hover:bg-orange-600 transition-colors">
                    ç¢ºå®š
                </button>
            </div>
        </div>
    </div>

    <!-- å°å‡ºå ±å‘Šå½ˆçª— -->
    <div id="export-modal" class="modal-overlay">
        <div class="modal-content">
            <div class="flex items-center justify-between p-6 border-b border-gray-200/50">
                <h3 class="text-lg font-semibold text-gray-800">ğŸ“¤ å°å‡ºAMLå ±å‘Š</h3>
                <button onclick="closeExportModal()" class="text-gray-500 hover:text-gray-700">
                    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                    </svg>
                </button>
            </div>
            
            <div class="p-6">
                <div class="mb-6">
                    <h4 class="font-medium text-gray-800 mb-3">é¸æ“‡å°å‡ºæ ¼å¼</h4>
                    <div class="grid grid-cols-2 gap-3">
                        <label class="flex items-center p-3 border border-gray-200 rounded-lg cursor-pointer hover:border-orange-400 transition-colors">
                            <input type="radio" name="export-format" value="pdf" class="mr-3" checked>
                            <span class="text-sm">ğŸ“„ PDF å ±å‘Š</span>
                        </label>
                        <label class="flex items-center p-3 border border-gray-200 rounded-lg cursor-pointer hover:border-orange-400 transition-colors">
                            <input type="radio" name="export-format" value="excel" class="mr-3">
                            <span class="text-sm">ğŸ“Š Excel è¡¨æ ¼</span>
                        </label>
                        <label class="flex items-center p-3 border border-gray-200 rounded-lg cursor-pointer hover:border-orange-400 transition-colors">
                            <input type="radio" name="export-format" value="json" class="mr-3">
                            <span class="text-sm">ğŸ“‹ JSON æ•¸æ“š</span>
                        </label>
                        <label class="flex items-center p-3 border border-gray-200 rounded-lg cursor-pointer hover:border-orange-400 transition-colors">
                            <input type="radio" name="export-format" value="xml" class="mr-3">
                            <span class="text-sm">ğŸ”— XML æ ¼å¼</span>
                        </label>
                    </div>
                </div>
                
                <div class="mb-6">
                    <h4 class="font-medium text-gray-800 mb-3">å ±å‘Šå…§å®¹</h4>
                    <div class="space-y-2">
                        <label class="flex items-center">
                            <input type="checkbox" class="mr-3" checked>
                            <span class="text-sm">äº¤æ˜“æ–¹ä¿¡æ¯</span>
                        </label>
                        <label class="flex items-center">
                            <input type="checkbox" class="mr-3" checked>
                            <span class="text-sm">äº¤æ˜“è©³æƒ…</span>
                        </label>
                        <label class="flex items-center">
                            <input type="checkbox" class="mr-3" checked>
                            <span class="text-sm">åœ‹å®¶/åœ°å€é¢¨éšªè©•ä¼°</span>
                        </label>
                        <label class="flex items-center">
                            <input type="checkbox" class="mr-3" checked>
                            <span class="text-sm">åå–®ç¯©æŸ¥çµæœ</span>
                        </label>
                        <label class="flex items-center">
                            <input type="checkbox" class="mr-3">
                            <span class="text-sm">åŸæ–‡æˆªåœ–é™„éŒ„</span>
                        </label>
                    </div>
                </div>
            </div>
            
            <div class="flex items-center justify-end gap-3 p-6 border-t border-gray-200/50">
                <button onclick="closeExportModal()" class="liquid-glass floating-button rounded-lg px-4 py-2 text-sm font-medium text-gray-700">
                    å–æ¶ˆ
                </button>
                <button onclick="doExport()" class="bg-orange-500 text-white rounded-lg px-4 py-2 text-sm font-medium hover:bg-orange-600 transition-colors">
                    ç¢ºèªå°å‡º
                </button>
            </div>
        </div>
    </div>

    <script>
        let uploadedFiles = [];
        let selectedDocTypes = ['lc'];
        let currentStep = 1;
        let isTyping = false;
        let extractionData = null;

        // æ›´æ–°æ­¥é©Ÿç‹€æ…‹
        function updateStepStatus(step) {
            for (let i = 1; i <= 4; i++) {
                const stepEl = document.getElementById(`step-${i}`);
                stepEl.classList.remove('active', 'completed');
                if (i < step) {
                    stepEl.classList.add('completed');
                } else if (i === step) {
                    stepEl.classList.add('active');
                }
            }
            currentStep = step;
        }

        // è·³è½‰åˆ°æŒ‡å®šæ­¥é©Ÿ
        function goToStep(step) {
            updateStepStatus(step);
            
            document.getElementById('upload-step').style.display = step === 1 ? 'block' : 'none';
            document.getElementById('doctype-step').style.display = step === 2 ? 'block' : 'none';
        }

        // è§¸ç™¼æ–‡ä»¶é¸æ“‡
        function triggerFileInput() {
            document.getElementById('file-input').click();
        }

        // è™•ç†æ‹–æ‹½
        function handleDragOver(e) {
            e.preventDefault();
            e.stopPropagation();
            document.getElementById('upload-zone').classList.add('dragover');
        }

        function handleDragLeave(e) {
            e.preventDefault();
            e.stopPropagation();
            document.getElementById('upload-zone').classList.remove('dragover');
        }

        function handleDrop(e) {
            e.preventDefault();
            e.stopPropagation();
            document.getElementById('upload-zone').classList.remove('dragover');
            
            const files = e.dataTransfer.files;
            if (files.length > 0) {
                processFiles(files);
            }
        }

        // è™•ç†æ–‡ä»¶ä¸Šå‚³
        function handleFileUpload(input) {
            if (input.files.length > 0) {
                processFiles(input.files);
            }
        }

        // è™•ç†æ–‡ä»¶
        function processFiles(files) {
            const maxSize = 50 * 1024 * 1024;
            
            for (let file of files) {
                if (file.size > maxSize) {
                    showToast(`æ–‡ä»¶"${file.name}"è¶…é50MBé™åˆ¶`, 'error');
                    continue;
                }
                uploadedFiles.push(file);
            }
            
            if (uploadedFiles.length === 0) return;
            
            const uploadZone = document.getElementById('upload-zone');
            uploadZone.classList.add('has-file');
            
            document.getElementById('upload-content').innerHTML = `
                <svg class="w-12 h-12 mx-auto mb-3 text-green-500" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                </svg>
                <h4 class="text-lg font-semibold text-green-600 mb-2">å·²ä¸Šå‚³ ${uploadedFiles.length} å€‹æ–‡ä»¶</h4>
                <p class="text-sm text-gray-600">é»æ“Šå¯ç¹¼çºŒæ·»åŠ æ–‡ä»¶</p>
            `;
            
            const previewArea = document.getElementById('file-preview-area');
            previewArea.style.display = 'block';
            previewArea.innerHTML = `
                <div class="mt-4 space-y-2">
                    ${uploadedFiles.map((file, index) => `
                        <div class="file-preview">
                            <div class="flex items-center">
                                <div class="w-10 h-10 bg-orange-100 rounded-lg flex items-center justify-center mr-3">
                                    <span class="text-orange-600 text-sm">${getFileIcon(file.name)}</span>
                                </div>
                                <div class="flex-1">
                                    <div class="font-medium text-gray-800 text-sm">${file.name}</div>
                                    <div class="text-xs text-gray-500">${(file.size / 1024 / 1024).toFixed(2)} MB</div>
                                </div>
                            </div>
                            <button onclick="removeFile(${index})" class="text-gray-400 hover:text-red-500 transition-colors">
                                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"></path>
                                </svg>
                            </button>
                        </div>
                    `).join('')}
                </div>
                <div class="mt-4 text-center">
                    <button onclick="goToStep(2)" class="bg-orange-500 text-white rounded-lg px-6 py-2 text-sm font-medium hover:bg-orange-600 transition-colors">
                        ä¸‹ä¸€æ­¥ï¼šç¢ºèªå–®æ“šé¡å‹ â†’
                    </button>
                </div>
            `;
            
            showToast(`æˆåŠŸä¸Šå‚³ ${files.length} å€‹æ–‡ä»¶`, 'success');
        }

        function getFileIcon(filename) {
            const ext = filename.split('.').pop().toLowerCase();
            const icons = {
                'pdf': 'ğŸ“„', 'doc': 'ğŸ“', 'docx': 'ğŸ“',
                'xls': 'ğŸ“Š', 'xlsx': 'ğŸ“Š', 'jpg': 'ğŸ–¼ï¸',
                'jpeg': 'ğŸ–¼ï¸', 'png': 'ğŸ–¼ï¸', 'tiff': 'ğŸ–¼ï¸', 'tif': 'ğŸ–¼ï¸'
            };
            return icons[ext] || 'ğŸ“‹';
        }

        // ç§»é™¤æ–‡ä»¶
        function removeFile(index) {
            uploadedFiles.splice(index, 1);
            
            if (uploadedFiles.length === 0) {
                resetUploadZone();
            } else {
                processFiles([]);
            }
        }

        function resetUploadZone() {
            uploadedFiles = [];
            const uploadZone = document.getElementById('upload-zone');
            uploadZone.classList.remove('has-file');
            
            document.getElementById('upload-content').innerHTML = `
                <svg class="w-16 h-16 mx-auto mb-4 text-orange-500" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"></path>
                </svg>
                <h4 class="text-xl font-semibold text-gray-700 mb-2">æ‹–æ‹½å–®æ“šåˆ°é€™è£¡</h4>
                <p class="text-gray-500 mb-4">æˆ–é»æ“Šé¸æ“‡æ–‡ä»¶ä¸Šå‚³ï¼ˆæ”¯æŒæ‰¹é‡ä¸Šå‚³ï¼‰</p>
                <div class="flex flex-wrap justify-center gap-2 text-xs text-gray-400">
                    <span class="bg-gray-100 px-2 py-1 rounded">PDF</span>
                    <span class="bg-gray-100 px-2 py-1 rounded">TIFF</span>
                    <span class="bg-gray-100 px-2 py-1 rounded">JPG/PNG</span>
                    <span class="bg-gray-100 px-2 py-1 rounded">Word</span>
                    <span class="bg-gray-100 px-2 py-1 rounded">Excel</span>
                    <span class="bg-gray-100 px-2 py-1 rounded">æœ€å¤§50MB</span>
                </div>
            `;
            
            document.getElementById('file-preview-area').style.display = 'none';
        }

        // é¸æ“‡å–®æ“šé¡å‹
        function selectDocType(element, type) {
            element.classList.toggle('selected');
            
            if (element.classList.contains('selected')) {
                if (!selectedDocTypes.includes(type)) {
                    selectedDocTypes.push(type);
                }
            } else {
                selectedDocTypes = selectedDocTypes.filter(t => t !== type);
            }
        }

        // é–‹å§‹AIæå–
        function startExtraction() {
            if (uploadedFiles.length === 0) {
                showToast('è«‹å…ˆä¸Šå‚³å–®æ“šæ–‡ä»¶', 'error');
                return;
            }
            
            updateStepStatus(3);
            
            document.getElementById('wizard-interface').style.display = 'none';
            document.getElementById('chat-area').style.display = 'block';
            document.getElementById('input-area').style.display = 'block';
            
            performExtraction();
        }

        // åŸ·è¡ŒAIæå–
        function performExtraction() {
            const fileNames = uploadedFiles.map(f => f.name).join('ã€');
            addMessageToChatArea('user', `è«‹å¾ä»¥ä¸‹å–®æ“šä¸­æå–AMLæ‰€éœ€ä¿¡æ¯ï¼š${fileNames}`);
            
            showTypingIndicator();
            
            // æ¨¡æ“¬AIè™•ç†éç¨‹
            setTimeout(() => {
                updateTypingMessage('æ­£åœ¨é€²è¡ŒOCRè­˜åˆ¥...');
            }, 1000);
            
            setTimeout(() => {
                updateTypingMessage('æ­£åœ¨æå–é—œéµä¿¡æ¯...');
            }, 2500);
            
            setTimeout(() => {
                updateTypingMessage('æ­£åœ¨é€²è¡Œåå–®ç¯©æŸ¥...');
            }, 4000);
            
            setTimeout(() => {
                updateTypingMessage('æ­£åœ¨è©•ä¼°åœ‹å®¶é¢¨éšª...');
            }, 5500);
            
            setTimeout(() => {
                hideTypingIndicator();
                updateStepStatus(4);
                
                // ç”Ÿæˆæå–çµæœ
                extractionData = generateExtractionResult();
                displayExtractionResult(extractionData);
                
            }, 7000);
        }

        // ç”Ÿæˆæ¨¡æ“¬æå–çµæœ
        function generateExtractionResult() {
            return {
                transactionId: 'TXN2024120001',
                lcNumber: document.getElementById('lc-number')?.value || 'LC2024HK00456',
                extractionTime: new Date().toLocaleString('zh-TW'),
                overallRisk: 'medium',
                
                applicant: {
                    name: 'ABC Trading Company Limited',
                    nameLocal: 'æ°¸è±è²¿æ˜“æœ‰é™å…¬å¸',
                    address: 'Unit 1205, Tower A, Lippo Centre, 89 Queensway, Hong Kong',
                    country: 'HK',
                    countryRisk: 'low',
                    screeningStatus: 'clear',
                    confidence: 96
                },
                
                beneficiary: {
                    name: 'Global Export Industries LLC',
                    nameLocal: null,
                    address: '456 Industrial Zone, Building C, Dubai, UAE',
                    country: 'AE',
                    countryRisk: 'medium',
                    screeningStatus: 'clear',
                    confidence: 94
                },
                
                issuingBank: {
                    name: 'Shanghai Commercial Bank Limited',
                    swiftCode: 'SCBLHKHH',
                    country: 'HK',
                    confidence: 99
                },
                
                advisingBank: {
                    name: 'Emirates NBD Bank',
                    swiftCode: 'EABORABC',
                    country: 'AE',
                    confidence: 97
                },
                
                transaction: {
                    amount: 'USD 1,250,000.00',
                    currency: 'USD',
                    goodsDescription: 'Electronic Components - Semiconductor Chips (HS Code: 8542.31)',
                    quantity: '50,000 PCS',
                    unitPrice: 'USD 25.00/PC',
                    confidence: 95
                },
                
                shipping: {
                    portOfLoading: 'Hong Kong',
                    portOfDischarge: 'Jebel Ali, Dubai',
                    shipmentDate: '2024-12-15',
                    vesselName: 'EVER GOLDEN',
                    countryRoute: ['HK', 'AE'],
                    confidence: 93
                },
                
                countriesInvolved: [
                    { code: 'HK', name: 'é¦™æ¸¯', risk: 'low' },
                    { code: 'AE', name: 'é˜¿è¯é…‹', risk: 'medium' },
                    { code: 'CN', name: 'ä¸­åœ‹ï¼ˆåŸç”¢åœ°ï¼‰', risk: 'low' }
                ],
                
                screeningResults: {
                    sanctionsList: { status: 'clear', matches: 0 },
                    pepList: { status: 'clear', matches: 0 },
                    adverseMedia: { status: 'clear', matches: 0 },
                    internalWatchlist: { status: 'clear', matches: 0 }
                },
                
                alerts: [
                    {
                        level: 'medium',
                        type: 'é«˜é¢¨éšªåœ°å€',
                        description: 'å—ç›Šäººæ‰€åœ¨åœ°é˜¿è¯é…‹å±¬æ–¼ä¸­ç­‰é¢¨éšªåœ°å€ï¼Œå»ºè­°åŠ å¼·ç›¡è·èª¿æŸ¥'
                    }
                ]
            };
        }

        // é¡¯ç¤ºæå–çµæœ
        function displayExtractionResult(data) {
            const resultHtml = `
                <div class="space-y-4">
                    <!-- ç¸½è¦½å¡ç‰‡ -->
                    <div class="aml-result-card">
                        <div class="bg-gradient-to-r from-orange-500 to-orange-600 p-4">
                            <div class="flex items-center justify-between">
                                <div class="text-white">
                                    <h3 class="font-semibold text-lg">AMLä¿¡æ¯æå–å ±å‘Š</h3>
                                    <p class="text-orange-100 text-sm">äº¤æ˜“ç·¨è™Ÿï¼š${data.transactionId}</p>
                                </div>
                                <div class="text-right">
                                    <span class="risk-badge ${data.overallRisk === 'high' ? 'risk-high' : data.overallRisk === 'medium' ? 'risk-medium' : 'risk-low'}">
                                        ${data.overallRisk === 'high' ? 'ğŸ”´ é«˜é¢¨éšª' : data.overallRisk === 'medium' ? 'ğŸŸ¡ ä¸­ç­‰é¢¨éšª' : 'ğŸŸ¢ ä½é¢¨éšª'}
                                    </span>
                                </div>
                            </div>
                        </div>
                        <div class="p-4 grid grid-cols-2 md:grid-cols-4 gap-4 text-sm">
                            <div>
                                <div class="text-gray-500">ä¿¡ç”¨è­‰ç·¨è™Ÿ</div>
                                <div class="font-medium">${data.lcNumber}</div>
                            </div>
                            <div>
                                <div class="text-gray-500">äº¤æ˜“é‡‘é¡</div>
                                <div class="font-medium text-orange-600">${data.transaction.amount}</div>
                            </div>
                            <div>
                                <div class="text-gray-500">æå–æ™‚é–“</div>
                                <div class="font-medium">${data.extractionTime}</div>
                            </div>
                            <div>
                                <div class="text-gray-500">æ¶‰åŠåœ‹å®¶</div>
                                <div class="font-medium">${data.countriesInvolved.length} å€‹</div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- è­¦ç¤ºä¿¡æ¯ -->
                    ${data.alerts.length > 0 ? `
                    <div class="bg-yellow-50 border border-yellow-200 rounded-xl p-4">
                        <div class="flex items-start">
                            <span class="text-yellow-500 text-xl mr-3">âš ï¸</span>
                            <div>
                                <h4 class="font-medium text-yellow-800">æ³¨æ„äº‹é …</h4>
                                ${data.alerts.map(alert => `
                                    <p class="text-sm text-yellow-700 mt-1">â€¢ ${alert.description}</p>
                                `).join('')}
                            </div>
                        </div>
                    </div>
                    ` : ''}
                    
                    <!-- äº¤æ˜“æ–¹ä¿¡æ¯ -->
                    <div class="aml-result-card p-4">
                        <h4 class="font-semibold text-gray-800 mb-4 flex items-center">
                            <span class="text-lg mr-2">ğŸ‘¥</span> äº¤æ˜“æ–¹ä¿¡æ¯
                        </h4>
                        
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                            <!-- ç”³è«‹äºº -->
                            <div class="entity-card">
                                <div class="flex items-center justify-between mb-3">
                                    <span class="text-sm font-medium text-gray-500">ç”³è«‹äºº (Applicant)</span>
                                    <span class="screening-status status-clear">âœ“ åå–®æ¸…æ½”</span>
                                </div>
                                <div class="space-y-2">
                                    <div class="extracted-field" onclick="showSource('applicant-name')">
                                        <div class="text-xs text-gray-400">å…¬å¸åç¨±</div>
                                        <div class="font-medium">${data.applicant.name}</div>
                                        ${data.applicant.nameLocal ? `<div class="text-sm text-gray-600">${data.applicant.nameLocal}</div>` : ''}
                                    </div>
                                    <div class="extracted-field" onclick="showSource('applicant-address')">
                                        <div class="text-xs text-gray-400">åœ°å€</div>
                                        <div class="text-sm">${data.applicant.address}</div>
                                    </div>
                                    <div class="flex items-center gap-2">
                                        <span class="country-tag country-safe">ğŸ‡­ğŸ‡° é¦™æ¸¯</span>
                                        <span class="text-xs text-gray-400">ç½®ä¿¡åº¦: ${data.applicant.confidence}%</span>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- å—ç›Šäºº -->
                            <div class="entity-card ${data.beneficiary.countryRisk === 'medium' ? 'alert' : ''}">
                                <div class="flex items-center justify-between mb-3">
                                    <span class="text-sm font-medium text-gray-500">å—ç›Šäºº (Beneficiary)</span>
                                    <span class="screening-status status-clear">âœ“ åå–®æ¸…æ½”</span>
                                </div>
                                <div class="space-y-2">
                                    <div class="extracted-field" onclick="showSource('beneficiary-name')">
                                        <div class="text-xs text-gray-400">å…¬å¸åç¨±</div>
                                        <div class="font-medium">${data.beneficiary.name}</div>
                                    </div>
                                    <div class="extracted-field" onclick="showSource('beneficiary-address')">
                                        <div class="text-xs text-gray-400">åœ°å€</div>
                                        <div class="text-sm">${data.beneficiary.address}</div>
                                    </div>
                                    <div class="flex items-center gap-2">
                                        <span class="country-tag country-watch">ğŸ‡¦ğŸ‡ª é˜¿è¯é…‹ âš ï¸</span>
                                        <span class="text-xs text-gray-400">ç½®ä¿¡åº¦: ${data.beneficiary.confidence}%</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- äº¤æ˜“è©³æƒ… -->
                    <div class="aml-result-card p-4">
                        <h4 class="font-semibold text-gray-800 mb-4 flex items-center">
                            <span class="text-lg mr-2">ğŸ’°</span> äº¤æ˜“è©³æƒ…
                        </h4>
                        <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                            <div class="extracted-field" onclick="showSource('amount')">
                                <div class="text-xs text-gray-400">äº¤æ˜“é‡‘é¡</div>
                                <div class="font-semibold text-lg text-orange-600">${data.transaction.amount}</div>
                            </div>
                            <div class="extracted-field" onclick="showSource('goods')">
                                <div class="text-xs text-gray-400">è²¨ç‰©æè¿°</div>
                                <div class="text-sm">${data.transaction.goodsDescription}</div>
                            </div>
                            <div class="extracted-field" onclick="showSource('quantity')">
                                <div class="text-xs text-gray-400">æ•¸é‡/å–®åƒ¹</div>
                                <div class="text-sm">${data.transaction.quantity} @ ${data.transaction.unitPrice}</div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- é‹è¼¸ä¿¡æ¯ -->
                    <div class="aml-result-card p-4">
                        <h4 class="font-semibold text-gray-800 mb-4 flex items-center">
                            <span class="text-lg mr-2">ğŸš¢</span> é‹è¼¸ä¿¡æ¯
                        </h4>
                        <div class="grid grid-cols-2 md:grid-cols-4 gap-4">
                            <div class="extracted-field" onclick="showSource('pol')">
                                <div class="text-xs text-gray-400">è£è²¨æ¸¯</div>
                                <div class="font-medium">${data.shipping.portOfLoading}</div>
                            </div>
                            <div class="extracted-field" onclick="showSource('pod')">
                                <div class="text-xs text-gray-400">å¸è²¨æ¸¯</div>
                                <div class="font-medium">${data.shipping.portOfDischarge}</div>
                            </div>
                            <div class="extracted-field" onclick="showSource('shipdate')">
                                <div class="text-xs text-gray-400">è£é‹æ—¥æœŸ</div>
                                <div class="font-medium">${data.shipping.shipmentDate}</div>
                            </div>
                            <div class="extracted-field" onclick="showSource('vessel')">
                                <div class="text-xs text-gray-400">èˆ¹å</div>
                                <div class="font-medium">${data.shipping.vesselName}</div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- åœ‹å®¶é¢¨éšªè©•ä¼° -->
                    <div class="aml-result-card p-4">
                        <h4 class="font-semibold text-gray-800 mb-4 flex items-center">
                            <span class="text-lg mr-2">ğŸŒ</span> æ¶‰åŠåœ‹å®¶/åœ°å€
                        </h4>
                        <div class="flex flex-wrap gap-2">
                            ${data.countriesInvolved.map(c => `
                                <span class="country-tag ${c.risk === 'low' ? 'country-safe' : c.risk === 'medium' ? 'country-watch' : 'country-sanctioned'}">
                                    ${c.name} ${c.risk === 'medium' ? 'âš ï¸' : c.risk === 'high' ? 'ğŸš«' : 'âœ“'}
                                </span>
                            `).join('')}
                        </div>
                    </div>
                    
                    <!-- åå–®ç¯©æŸ¥çµæœ -->
                    <div class="aml-result-card p-4">
                        <h4 class="font-semibold text-gray-800 mb-4 flex items-center">
                            <span class="text-lg mr-2">ğŸ”</span> åå–®ç¯©æŸ¥çµæœ
                        </h4>
                        <div class="grid grid-cols-2 md:grid-cols-4 gap-4">
                            <div class="text-center p-3 bg-green-50 rounded-lg">
                                <div class="text-2xl mb-1">âœ…</div>
                                <div class="text-sm font-medium">åˆ¶è£åå–®</div>
                                <div class="text-xs text-green-600">ç„¡åŒ¹é…</div>
                            </div>
                            <div class="text-center p-3 bg-green-50 rounded-lg">
                                <div class="text-2xl mb-1">âœ…</div>
                                <div class="text-sm font-medium">PEPåå–®</div>
                                <div class="text-xs text-green-600">ç„¡åŒ¹é…</div>
                            </div>
                            <div class="text-center p-3 bg-green-50 rounded-lg">
                                <div class="text-2xl mb-1">âœ…</div>
                                <div class="text-sm font-medium">è² é¢æ–°è</div>
                                <div class="text-xs text-green-600">ç„¡åŒ¹é…</div>
                            </div>
                            <div class="text-center p-3 bg-green-50 rounded-lg">
                                <div class="text-2xl mb-1">âœ…</div>
                                <div class="text-sm font-medium">å…§éƒ¨ç›£å¯Ÿ</div>
                                <div class="text-xs text-green-600">ç„¡åŒ¹é…</div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- æ“ä½œæŒ‰éˆ• -->
                    <div class="flex flex-wrap gap-3 justify-center pt-4">
                        <button onclick="showExportModal()" class="action-btn bg-orange-500 text-white border-orange-500 hover:bg-orange-600">
                            <span>ğŸ“¤</span> å°å‡ºå ±å‘Š
                        </button>
                        <button onclick="submitToAML()" class="action-btn bg-green-500 text-white border-green-500 hover:bg-green-600">
                            <span>âœ“</span> æäº¤è‡³AMLç³»çµ±
                        </button>
                        <button onclick="requestReview()" class="action-btn">
                            <span>ğŸ‘¤</span> ç”³è«‹äººå·¥è¤‡æ ¸
                        </button>
                        <button onclick="editExtraction()" class="action-btn">
                            <span>âœï¸</span> ç·¨è¼¯ä¿®æ­£
                        </button>
                    </div>
                </div>
            `;
            
            addMessageToChatArea('assistant', resultHtml, null, true);
            
            // æ·»åŠ å¾ŒçºŒæ“ä½œå»ºè­°
            setTimeout(() => {
                const suggestionsHtml = `
                    <div class="mt-4">
                        <p class="text-gray-600 mb-3">æ‚¨é‚„å¯ä»¥ï¼š</p>
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-3">
                            <button onclick="askFollowUp('è©³ç´°è§£é‡‹å—ç›Šäººæ‰€åœ¨åœ°çš„é¢¨éšªè©•ä¼°')" class="doc-type-card text-left">
                                <div class="flex items-center">
                                    <span class="mr-2">ğŸ”</span>
                                    <span class="text-sm">è©³ç´°è§£é‡‹é˜¿è¯é…‹çš„é¢¨éšªè©•ä¼°</span>
                                </div>
                            </button>
                            <button onclick="askFollowUp('è£œå……æå–éŠ€è¡Œä¿¡æ¯')" class="doc-type-card text-left">
                                <div class="flex items-center">
                                    <span class="mr-2">ğŸ¦</span>
                                    <span class="text-sm">è£œå……æå–éŠ€è¡Œä¿¡æ¯</span>
                                </div>
                            </button>
                            <button onclick="askFollowUp('ç”Ÿæˆå¢å¼·ç›¡è·èª¿æŸ¥å»ºè­°')" class="doc-type-card text-left">
                                <div class="flex items-center">
                                    <span class="mr-2">ğŸ“‹</span>
                                    <span class="text-sm">ç”Ÿæˆå¢å¼·ç›¡è·èª¿æŸ¥å»ºè­°</span>
                                </div>
                            </button>
                            <button onclick="askFollowUp('å°æ¯”æ­·å²äº¤æ˜“è¨˜éŒ„')" class="doc-type-card text-left">
                                <div class="flex items-center">
                                    <span class="mr-2">ğŸ“Š</span>
                                    <span class="text-sm">å°æ¯”æ­·å²äº¤æ˜“è¨˜éŒ„</span>
                                </div>
                            </button>
                        </div>
                    </div>
                `;
                
                const suggestionsDiv = document.createElement('div');
                suggestionsDiv.className = 'message-bubble assistant-message p-4 mb-4';
                suggestionsDiv.innerHTML = suggestionsHtml;
                document.getElementById('chat-area').appendChild(suggestionsDiv);
                scrollToBottom();
                
            }, 500);
        }

        // æ·»åŠ æ¶ˆæ¯åˆ°èŠå¤©å€åŸŸ
        function addMessageToChatArea(sender, content, source = null, isHtml = false) {
            const chatArea = document.getElementById('chat-area');
            const messageDiv = document.createElement('div');
            const messageId = 'msg_' + Date.now();
            messageDiv.className = `message-bubble ${sender}-message p-4 mb-4`;
            messageDiv.id = messageId;
            
            if (sender === 'assistant') {
                if (isHtml) {
                    messageDiv.innerHTML = content;
                } else {
                    messageDiv.innerHTML = `<div class="prose prose-sm max-w-none">${renderMarkdown(content)}</div>`;
                }
            } else {
                messageDiv.textContent = content;
            }
            
            chatArea.appendChild(messageDiv);
            scrollToBottom();
        }

        function renderMarkdown(text) {
            return text
                .replace(/\*\*(.*?)\*\*/g, '<strong>$1</strong>')
                .replace(/\*(.*?)\*/g, '<em>$1</em>')
                .replace(/\n/g, '<br>');
        }

        function scrollToBottom() {
            const chatArea = document.getElementById('chat-area');
            chatArea.scrollTop = chatArea.scrollHeight;
        }

        // é¡¯ç¤ºæ‰“å­—æŒ‡ç¤ºå™¨
        function showTypingIndicator() {
            isTyping = true;
            const chatArea = document.getElementById('chat-area');
            const typingDiv = document.createElement('div');
            typingDiv.id = 'typing-indicator';
            typingDiv.className = 'typing-indicator mb-4';
            typingDiv.innerHTML = `
                <div class="typing-dot"></div>
                <div class="typing-dot"></div>
                <div class="typing-dot"></div>
                <span class="ml-2 text-sm text-gray-500" id="typing-text">æ­£åœ¨è™•ç†å–®æ“š...</span>
            `;
            chatArea.appendChild(typingDiv);
            scrollToBottom();
        }

        function updateTypingMessage(message) {
            const typingText = document.getElementById('typing-text');
            if (typingText) {
                typingText.textContent = message;
            }
        }

        function hideTypingIndicator() {
            isTyping = false;
            const indicator = document.getElementById('typing-indicator');
            if (indicator) {
                indicator.remove();
            }
        }

        // å¾ŒçºŒå•é¡Œ
        function askFollowUp(question) {
            addMessageToChatArea('user', question);
            showTypingIndicator();
            
            setTimeout(() => {
                hideTypingIndicator();
                
                let response = '';
                if (question.includes('é˜¿è¯é…‹') || question.includes('é¢¨éšªè©•ä¼°')) {
                    response = `
                        <div class="space-y-3">
                            <h4 class="font-semibold">ğŸŒ é˜¿è¯é…‹ (UAE) é¢¨éšªè©•ä¼°è©³æƒ…</h4>
                            
                            <div class="bg-yellow-50 rounded-lg p-4">
                                <div class="flex items-center mb-2">
                                    <span class="risk-badge risk-medium text-white">ä¸­ç­‰é¢¨éšª</span>
                                </div>
                                
                                <p class="text-sm text-gray-700 mb-3">
                                    é˜¿è¯é…‹è¢«è©•ç‚ºä¸­ç­‰é¢¨éšªåœ°å€ï¼Œä¸»è¦åŸºæ–¼ä»¥ä¸‹å› ç´ ï¼š
                                </p>
                                
                                <div class="space-y-2 text-sm">
                                    <div class="flex items-start">
                                        <span class="text-yellow-500 mr-2">âš ï¸</span>
                                        <span><strong>FATFç°åå–®ï¼š</strong>é˜¿è¯é…‹æ–¼2022å¹´è¢«åˆ—å…¥FATFåŠ å¼·ç›£æ¸¬åå–®</span>
                                    </div>
                                    <div class="flex items-start">
                                        <span class="text-yellow-500 mr-2">âš ï¸</span>
                                        <span><strong>è²¿æ˜“è½‰é‹ä¸­å¿ƒï¼š</strong>è¿ªæ‹œç‚ºé‡è¦è½‰å£æ¸¯ï¼Œå­˜åœ¨è²¿æ˜“æ´—éŒ¢é¢¨éšª</span>
                                    </div>
                                    <div class="flex items-start">
                                        <span class="text-green-500 mr-2">âœ“</span>
                                        <span><strong>æ­£é¢å› ç´ ï¼š</strong>UAEå·²æ¡å–å¤šé …AMLæ”¹é©æªæ–½ï¼Œé¢¨éšªæŒçºŒé™ä½</span>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="bg-blue-50 rounded-lg p-4">
                                <h5 class="font-medium text-blue-800 mb-2">ğŸ“‹ å»ºè­°æªæ–½</h5>
                                <ul class="text-sm text-blue-700 space-y-1">
                                    <li>â€¢ æ ¸å¯¦å—ç›Šäººçš„å…¬å¸è¨»å†Šä¿¡æ¯åŠç¶“ç‡ŸèƒŒæ™¯</li>
                                    <li>â€¢ ç¢ºèªäº¤æ˜“çš„å•†æ¥­åˆç†æ€§</li>
                                    <li>â€¢ æª¢æŸ¥æ˜¯å¦å­˜åœ¨ç•°å¸¸çš„ä»˜æ¬¾æ¨¡å¼</li>
                                    <li>â€¢ ä¿ç•™å®Œæ•´çš„äº¤æ˜“è¨˜éŒ„ä»¥å‚™å¯©è¨ˆ</li>
                                </ul>
                            </div>
                        </div>
                    `;
                } else if (question.includes('éŠ€è¡Œä¿¡æ¯')) {
                    response = `
                        <div class="space-y-3">
                            <h4 class="font-semibold">ğŸ¦ éŠ€è¡Œä¿¡æ¯æå–çµæœ</h4>
                            
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                <div class="entity-card">
                                    <div class="text-sm font-medium text-gray-500 mb-2">é–‹è­‰è¡Œ (Issuing Bank)</div>
                                    <div class="font-medium">Shanghai Commercial Bank Limited</div>
                                    <div class="text-sm text-gray-600">SWIFT: SCBLHKHH</div>
                                    <span class="country-tag country-safe mt-2">ğŸ‡­ğŸ‡° é¦™æ¸¯</span>
                                </div>
                                
                                <div class="entity-card">
                                    <div class="text-sm font-medium text-gray-500 mb-2">é€šçŸ¥è¡Œ (Advising Bank)</div>
                                    <div class="font-medium">Emirates NBD Bank</div>
                                    <div class="text-sm text-gray-600">SWIFT: EABORABC</div>
                                    <span class="country-tag country-watch mt-2">ğŸ‡¦ğŸ‡ª é˜¿è¯é…‹</span>
                                </div>
                            </div>
                        </div>
                    `;
                } else if (question.includes('ç›¡è·èª¿æŸ¥')) {
                    response = `
                        <div class="space-y-3">
                            <h4 class="font-semibold">ğŸ“‹ å¢å¼·ç›¡è·èª¿æŸ¥ (EDD) å»ºè­°</h4>
                            
                            <div class="bg-orange-50 rounded-lg p-4">
                                <p class="text-sm text-gray-700 mb-3">
                                    åŸºæ–¼æœ¬æ¬¡äº¤æ˜“æ¶‰åŠä¸­ç­‰é¢¨éšªåœ°å€ï¼Œå»ºè­°åŸ·è¡Œä»¥ä¸‹å¢å¼·ç›¡è·èª¿æŸ¥æªæ–½ï¼š
                                </p>
                                
                                <div class="space-y-3">
                                    <div class="flex items-start p-3 bg-white rounded-lg">
                                        <span class="text-orange-500 mr-3 text-lg">1ï¸âƒ£</span>
                                        <div>
                                            <div class="font-medium">æ ¸å¯¦å—ç›Šäººèº«ä»½</div>
                                            <div class="text-sm text-gray-600">ç²å–å—ç›Šäººçš„å…¬å¸è¨»å†Šæ–‡ä»¶ã€è‚¡æ±çµæ§‹åŠæœ€çµ‚å—ç›Šäººä¿¡æ¯</div>
                                        </div>
                                    </div>
                                    
                                    <div class="flex items-start p-3 bg-white rounded-lg">
                                        <span class="text-orange-500 mr-3 text-lg">2ï¸âƒ£</span>
                                        <div>
                                            <div class="font-medium">äº¤æ˜“èƒŒæ™¯èª¿æŸ¥</div>
                                            <div class="text-sm text-gray-600">ç¢ºèªäº¤æ˜“çš„å•†æ¥­ç›®çš„ã€å®šåƒ¹åˆç†æ€§åŠè²¨ç‰©æœ€çµ‚ç”¨é€”</div>
                                        </div>
                                    </div>
                                    
                                    <div class="flex items-start p-3 bg-white rounded-lg">
                                        <span class="text-orange-500 mr-3 text-lg">3ï¸âƒ£</span>
                                        <div>
                                            <div class="font-medium">è³‡é‡‘ä¾†æºç¢ºèª</div>
                                            <div class="text-sm text-gray-600">äº†è§£ç”³è«‹äººçš„è³‡é‡‘ä¾†æºåŠèˆ‡å—ç›Šäººçš„æ¥­å‹™é—œä¿‚</div>
                                        </div>
                                    </div>
                                    
                                    <div class="flex items-start p-3 bg-white rounded-lg">
                                        <span class="text-orange-500 mr-3 text-lg">4ï¸âƒ£</span>
                                        <div>
                                            <div class="font-medium">æŒçºŒç›£æ§</div>
                                            <div class="text-sm text-gray-600">å°‡è©²å®¢æˆ¶åˆ—å…¥åŠ å¼·ç›£æ§åå–®ï¼Œå®šæœŸå¯©æŸ¥äº¤æ˜“æ¨¡å¼</div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    `;
                } else {
                    response = `æ ¹æ“šæ‚¨çš„éœ€æ±‚ã€Œ${question}ã€ï¼Œæˆ‘æ­£åœ¨è™•ç†ç›¸é—œåˆ†æã€‚ç”±æ–¼é€™æ˜¯æ¼”ç¤ºç‰ˆæœ¬ï¼Œå¯¦éš›åŠŸèƒ½å°‡çµåˆå®Œæ•´çš„æ•¸æ“šåº«å’ŒAIåˆ†æèƒ½åŠ›æä¾›æ›´è©³ç›¡çš„çµæœã€‚`;
                }
                
                addMessageToChatArea('assistant', response, null, true);
            }, 1500);
        }

        // ç™¼é€æ¶ˆæ¯
        function sendMessage() {
            const input = document.getElementById('message-input');
            const message = input.value.trim();
            
            if (!message || isTyping) return;
            
            addMessageToChatArea('user', message);
            input.value = '';
            
            askFollowUp(message);
        }

        // é‡ç½®åš®å°
        function resetWizard() {
            uploadedFiles = [];
            selectedDocTypes = ['lc'];
            currentStep = 1;
            extractionData = null;
            
            document.getElementById('wizard-interface').style.display = 'block';
            document.getElementById('chat-area').style.display = 'none';
            document.getElementById('chat-area').innerHTML = '';
            document.getElementById('input-area').style.display = 'none';
            
            updateStepStatus(1);
            goToStep(1);
            resetUploadZone();
            
            document.querySelectorAll('.doc-type-card').forEach(card => {
                card.classList.remove('selected');
            });
            document.querySelector('.doc-type-card').classList.add('selected');
            
            document.getElementById('lc-number').value = '';
            document.getElementById('customer-id').value = '';
            
            showToast('å·²é‡ç½®ï¼Œå¯ä»¥æ–°å»ºæå–ä»»å‹™', 'info');
        }

        // é¡¯ç¤ºä¾†æº
        function showSource(field) {
            document.getElementById('source-doc').textContent = uploadedFiles[0]?.name || 'Commercial_Invoice_2024.pdf';
            document.getElementById('source-page').textContent = 'ç¬¬ 1 é ';
            document.getElementById('source-location').textContent = 'æ–‡æª”é ‚éƒ¨å€åŸŸ';
            document.getElementById('source-content').innerHTML = 'Applicant: ABC Trading Company Limited<br>Address: Unit 1205, Tower A, Lippo Centre...';
            document.getElementById('confidence-rate').textContent = '96%';
            
            document.getElementById('source-modal').classList.add('show');
        }

        function closeSourceModal() {
            document.getElementById('source-modal').classList.remove('show');
        }

        // å°å‡ºç›¸é—œ
        function showExportModal() {
            document.getElementById('export-modal').classList.add('show');
        }

        function closeExportModal() {
            document.getElementById('export-modal').classList.remove('show');
        }

        function doExport() {
            closeExportModal();
            showToast('AMLå ±å‘Šå°å‡ºæˆåŠŸï¼', 'success');
        }

        // å…¶ä»–æ“ä½œ
        function submitToAML() {
            showToast('å·²æˆåŠŸæäº¤è‡³AMLç³»çµ±é€²è¡Œå¾ŒçºŒè™•ç†', 'success');
        }

        function requestReview() {
            showToast('å·²ç”³è«‹äººå·¥è¤‡æ ¸ï¼Œå°‡é€šçŸ¥ç›¸é—œå¯©æ ¸äººå“¡', 'info');
        }

        function editExtraction() {
            showToast('ç·¨è¼¯åŠŸèƒ½é–‹ç™¼ä¸­ï¼Œæ•¬è«‹æœŸå¾…', 'info');
        }

        function showHistory() {
            showToast('æ­·å²è¨˜éŒ„åŠŸèƒ½é–‹ç™¼ä¸­', 'info');
        }

        // Toastæç¤º
        function showToast(message, type = 'info') {
            const toast = document.createElement('div');
            toast.className = `toast ${type}`;
            toast.innerHTML = `
                <div class="flex items-center">
                    <div class="mr-3">
                        ${type === 'success' ? 'âœ…' : type === 'error' ? 'âŒ' : type === 'warning' ? 'âš ï¸' : 'â„¹ï¸'}
                    </div>
                    <div class="font-medium text-gray-800">${message}</div>
                    <button onclick="this.parentElement.parentElement.remove()" class="ml-4 text-gray-500 hover:text-gray-700">
                        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                        </svg>
                    </button>
                </div>
            `;
            
            document.body.appendChild(toast);
            setTimeout(() => toast.classList.add('show'), 100);
            setTimeout(() => {
                toast.classList.remove('show');
                setTimeout(() => toast.remove(), 300);
            }, 3000);
        }

        // åˆå§‹åŒ–
        document.addEventListener('DOMContentLoaded', function() {
            console.log('è²¿æ˜“èè³‡AMLä¿¡æ¯æå–åŠ©æ‰‹å·²åŠ è¼‰å®Œæˆ');
            updateStepStatus(1);
            
            document.getElementById('source-modal').addEventListener('click', function(e) {
                if (e.target === this) closeSourceModal();
            });
            
            document.getElementById('export-modal').addEventListener('click', function(e) {
                if (e.target === this) closeExportModal();
            });
        });
    </script>
</body>
</html>